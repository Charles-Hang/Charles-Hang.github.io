[{"title":"[学习笔记]《你不知道的JavaScript（上）》核心知识点","url":"http://charles-hang.github.io/2017/03/29/sn-js-youDontKnowJs1/","content":"<h1 id=\"第一部分-作用域和闭包\"><a href=\"#第一部分-作用域和闭包\" class=\"headerlink\" title=\"第一部分 作用域和闭包\"></a>第一部分 作用域和闭包</h1><h2 id=\"第4章-提升\"><a href=\"#第4章-提升\" class=\"headerlink\" title=\"第4章 提升\"></a>第4章 提升</h2><p>编译器会在解释JavaScript代码之前进行编译，包括变量和函数在内的所有声明都会在任何代码被执行前首先处理，即把它们在代码中出现的位置“移动”到最上面，这个过程就是提升。示例：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">console</span>.log(a);</div><div class=\"line\"><span class=\"keyword\">var</span> a = a;</div><div class=\"line\"></div><div class=\"line\">==&gt;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> a;</div><div class=\"line\"><span class=\"built_in\">console</span>.log(a); <span class=\"comment\">// undefined</span></div><div class=\"line\">a = a; </div><div class=\"line\"></div><div class=\"line\">====</div><div class=\"line\"></div><div class=\"line\">foo();</div><div class=\"line\">bar();</div><div class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// ...</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">==&gt;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> foo;</div><div class=\"line\">foo(); <span class=\"comment\">// TypeError</span></div><div class=\"line\">bar(); <span class=\"comment\">// ReferenceError</span></div><div class=\"line\">foo = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> bar = ...self...</div><div class=\"line\">    <span class=\"comment\">// ...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>函数声明和变量声明都会被提升，但是函数会首先被提升，然后才是变量。示例：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">foo();</div><div class=\"line\"><span class=\"keyword\">var</span> foo;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>);</div><div class=\"line\">&#125;</div><div class=\"line\">foo = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">2</span>);</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">==&gt;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">1</span>);</div><div class=\"line\">&#125;</div><div class=\"line\">foo(); <span class=\"comment\">// 1</span></div><div class=\"line\">foo = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"number\">2</span>);</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<h3 id=\"提示\"><a href=\"#提示\" class=\"headerlink\" title=\"提示\"></a>提示</h3><p>声明本身会被提升，而包括函数表达式的赋值在内的赋值操作并不会提升。要注意避免重复声明，特别是当普通的var声明和函数声明混合在一起的时候，会有很多危险！</p>\n<h2 id=\"第5章-作用域闭包\"><a href=\"#第5章-作用域闭包\" class=\"headerlink\" title=\"第5章 作用域闭包\"></a>第5章 作用域闭包</h2><p>当函数可以记住并访问所在的词法作用域时，就产生了闭包。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> a = <span class=\"number\">2</span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(a);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> bar;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> baz = foo();</div><div class=\"line\">baz(); <span class=\"comment\">// 2 ---闭包的效果</span></div></pre></td></tr></table></figure></p>\n<p><code>foo()</code>执行后，通常整个内部作用域都被销毁，但由于<code>bar()</code>本身在使用，就阻止了回收，它拥有<code>foo()</code>内部作用域的闭包，使得该作用域能够一直存活，以供<code>bar()</code>在之后任何时间进行引用。<code>bar()</code>一直持有对该作用域的引用，这个引用就叫作闭包。<br>本质上无论何时何地，如果将函数（访问它们各自的词法作用域）当作第一级的值类型并到处传递，你就会看到闭包在这些函数中的应用。在定时器、事件监听器、Ajax请求、跨窗口通信、web workers或者任何其他的异步（或者同步）任务中，只要使用了回调函数，实际上就是在使用闭包！<br>立即执行函数创造的新的作用域，也就是创造了闭包，只是没有在其他的作用域使用。</p>\n<h3 id=\"模块\"><a href=\"#模块\" class=\"headerlink\" title=\"模块\"></a>模块</h3><p>闭包的一个强大应用就是模块：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CoolModule</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> something = <span class=\"string\">\"cool\"</span>;</div><div class=\"line\">    <span class=\"keyword\">var</span> another = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>];</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSomething</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(something);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doAnother</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(another.join(<span class=\"string\">\"!\"</span>));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span>&#123;</div><div class=\"line\">        <span class=\"attr\">doSomething</span>: doSomething,</div><div class=\"line\">        <span class=\"attr\">doAnother</span>: doAnoter</div><div class=\"line\">    &#125;;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> foo = CoolModule();</div><div class=\"line\">foo.doSomething(); <span class=\"comment\">// cool</span></div><div class=\"line\">foo.doAnother(); <span class=\"comment\">// 1 ! 2 ! 3</span></div></pre></td></tr></table></figure></p>\n<p>CoolModule()只是一个函数，必须要通过调用它来创建一个模块实例。模块模式需要具备两个必要条件：</p>\n<ol>\n<li>必须有外部的封闭函数，该函数必须至少被调用一次（每次调用都会创建一个新的模块实例）。</li>\n<li>封闭函数必须返回至少一个内部函数，这样内部函数才能在私有作用域中形成闭包，并且可以访问或者修改私有的状态。<br>一个从函数调用所返回的，只有数据属性而没有闭包函数的对象并不是真正的模块。<br>es6已经提供了一个稳定的模块API供我们使用。<h2 id=\"附录A-动态作用域\"><a href=\"#附录A-动态作用域\" class=\"headerlink\" title=\"附录A 动态作用域\"></a>附录A 动态作用域</h2>JavaScript中的作用域就是词法作用域，词法作用域最重要的特征是它的定义过程发生在代码的书写阶段。而动态作用域是一个在运行时被动态确定的形式，它们不关心函数和作用域时如何声明以及在何处声明的，只关心它们从何处调用。这里之所以要提及动态作用域，是因为JavaScript的this机制某种程度上很像动态作用域，它是在运行时动态确定的，this关注函数如何调用。<h1 id=\"第二部分-this和对象原型\"><a href=\"#第二部分-this和对象原型\" class=\"headerlink\" title=\"第二部分 this和对象原型\"></a>第二部分 this和对象原型</h1><h3 id=\"this到底是什么\"><a href=\"#this到底是什么\" class=\"headerlink\" title=\"this到底是什么\"></a>this到底是什么</h3>this是在运行时进行绑定的，并不是在编写时绑定，它的上下文取决于函数调用时的各种条件。当一个函数调用时，会创建一个执行上下文，这个上下文会包含函数在哪里被调用（调用栈）、函数的调用方法、传入的参数等信息。this就是这个上下文的其中一个属性。<h2 id=\"this全面解析\"><a href=\"#this全面解析\" class=\"headerlink\" title=\"this全面解析\"></a>this全面解析</h2><h3 id=\"调用位置\"><a href=\"#调用位置\" class=\"headerlink\" title=\"调用位置\"></a>调用位置</h3>找到调用位置，最重要的是要分析调用栈（就是为了达到当前执行位置所调用的所有函数）。调用位置就是在当前正在执行的函数的前一个调用中。示例：<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">baz</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 当前调用栈是： baz</span></div><div class=\"line\">    <span class=\"comment\">// 因此，当前调用位置是全局作用域</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"built_in\">console</span>.log( <span class=\"string\">\"baz\"</span>);</div><div class=\"line\">    bar(); <span class=\"comment\">// &lt;-- bar的调用位置</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 当前调用栈是baz -&gt; bar</span></div><div class=\"line\">    <span class=\"comment\">// 因此，当前调用位置在baz中</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"bar\"</span>);</div><div class=\"line\">    foo(); <span class=\"comment\">// &lt;-- foo的调用位置</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 当前调用栈是baz -&gt; bar -&gt; foo</span></div><div class=\"line\">    <span class=\"comment\">// 因此，当前调用位置在bar中</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"foo\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\">baz(); <span class=\"comment\">// &lt;-- baz的调用位置</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"绑定规则\"><a href=\"#绑定规则\" class=\"headerlink\" title=\"绑定规则\"></a>绑定规则</h3><h4 id=\"默认绑定\"><a href=\"#默认绑定\" class=\"headerlink\" title=\"默认绑定\"></a>默认绑定</h4><p>当函数不带任何修饰的进行调用时，即独立函数调用，使用默认绑定。默认绑定下，如果函数使用严格模式，this会绑定到undefined，否则指向全局对象。</p>\n<h4 id=\"隐式绑定\"><a href=\"#隐式绑定\" class=\"headerlink\" title=\"隐式绑定\"></a>隐式绑定</h4><p>这条规则是要考虑调用位置是否有上下文对象，或者说是否被某个对象拥有或者包含。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.a);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>: <span class=\"number\">2</span>,</div><div class=\"line\">    <span class=\"attr\">foo</span>: foo</div><div class=\"line\">&#125;;</div><div class=\"line\">obj.foo(); <span class=\"comment\">// 2</span></div></pre></td></tr></table></figure></p>\n<p>把函数当作参数赋值，隐式绑定的函数会丢失绑定对象，会应用默认绑定规则。示例：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.a);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>: <span class=\"number\">2</span>,</div><div class=\"line\">    <span class=\"attr\">foo</span>: foo</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> bar = obj.foo; <span class=\"comment\">// 函数别名！</span></div><div class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"string\">\"oops, global\"</span>; <span class=\"comment\">// a是全局对象的属性</span></div><div class=\"line\">bar(); <span class=\"comment\">// \"oops, global\"</span></div></pre></td></tr></table></figure></p>\n<p><code>bar()</code>调用的是<code>foo()</code>函数本身。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.a);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doFoo</span>(<span class=\"params\">fn</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// fn 其实引用的是foo</span></div><div class=\"line\"></div><div class=\"line\">    fn(); <span class=\"comment\">// &lt;-- 调用位置</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>: <span class=\"number\">2</span>,</div><div class=\"line\">    <span class=\"attr\">foo</span>: foo</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"string\">\"oops, global\"</span>; <span class=\"comment\">// a是全局对象的属性</span></div><div class=\"line\">doFoo(obj.foo); <span class=\"comment\">// \"oops, global\"</span></div><div class=\"line\"><span class=\"string\">``</span><span class=\"string\">` </span></div><div class=\"line\">参数传递其实就是一种隐式赋值，结果和上一个例子一样。</div><div class=\"line\">#### 显示绑定</div><div class=\"line\">使用Function.prototype.call Function.prototype.apply Function.prototype.bind 方法可以强制将this绑定到某一上下文上。</div><div class=\"line\">#### new绑定</div><div class=\"line\">JavaScript虽然也有一个new操作符，但它与其他面向类的语言安全不同，并不存在所谓的构造函数，只有对于函数的构造调用。使用new来调用函数，会自动执行下面的操作：</div><div class=\"line\">1. 创建（或者说构造）一个全新的对象。</div><div class=\"line\">2. 这个新对象会被执行【【原型】】连接。</div><div class=\"line\">3. 这个新对象会绑定到函数调用的this。</div><div class=\"line\">4. 如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象。</div><div class=\"line\">new是最后一种可以影响函数调用时this绑定行为的方法，称之为new绑定。</div><div class=\"line\">### 优先级</div><div class=\"line\">new绑定 &gt; 显示绑定 &gt; 隐式绑定 &gt; 默认绑定</div><div class=\"line\">### 一种情况</div><div class=\"line\">把null或者undefined作为this的绑定对象传入call、apply或bind时，应用的是默认绑定规则。这时为了不对全局对象产生影响，可以用Object.create(null)创建一个空对象将this绑定在这个空对象中：`foo.apply(<span class=\"built_in\">Object</span>.create(<span class=\"literal\">null</span>),[<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])<span class=\"string\">`。</span></div><div class=\"line\">## 第3章 对象</div><div class=\"line\">### 类型</div><div class=\"line\">举个例子来说明：</div><div class=\"line\">`<span class=\"string\">``</span>js</div><div class=\"line\"><span class=\"keyword\">var</span> strPrimitive = <span class=\"string\">\"I am a string\"</span>;</div><div class=\"line\"><span class=\"keyword\">typeof</span> strPrimitive; <span class=\"comment\">// \"string\"</span></div><div class=\"line\">strPrimitive <span class=\"keyword\">instanceof</span> <span class=\"built_in\">String</span>; <span class=\"comment\">//false</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> strObject = <span class=\"keyword\">new</span> <span class=\"built_in\">String</span>(<span class=\"string\">\"I am a string\"</span>);</div><div class=\"line\"><span class=\"keyword\">typeof</span> strObject; <span class=\"comment\">// \"object\"</span></div><div class=\"line\">strObject <span class=\"keyword\">instanceof</span> <span class=\"built_in\">String</span>; <span class=\"comment\">// true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">Object</span>.prototype.toString.call(strObject); <span class=\"comment\">// [object String]</span></div></pre></td></tr></table></figure></p>\n<p>上面strPrimitive只是一个string基本类型，不可变的值，而strObject是一个String对象。之所以可以直接对string基本类型使用String对象的方法是因为JavaScript会在必要时自动把字符串字面量转换成一个String对象，数值字面量也是如此，因此定义时推荐用字面量的形式，简洁方便。</p>\n<h3 id=\"内容\"><a href=\"#内容\" class=\"headerlink\" title=\"内容\"></a>内容</h3><p>在对象中，属性名永远都是字符串。如果你是用string（字面量）以外的其他值作为属性名，那它也会首先被转换成字符串，即使数字也不例外，虽然在数组下标中使用的是数字，但在对象属性名中数字会被转换成字符串，所以当心不要搞混对象和数值中数字的用法：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123; &#125;;</div><div class=\"line\">myObject[<span class=\"literal\">true</span>] = <span class=\"string\">\"foo\"</span>;</div><div class=\"line\">myObject[<span class=\"number\">3</span>] = <span class=\"string\">\"bar\"</span>;</div><div class=\"line\">myObject[myObject] = <span class=\"string\">\"baz\"</span>;</div><div class=\"line\"></div><div class=\"line\">myObject[<span class=\"string\">\"true\"</span>]; <span class=\"comment\">// \"foo\"</span></div><div class=\"line\">myObject[<span class=\"string\">\"3\"</span>]; <span class=\"comment\">// \"bar\"</span></div><div class=\"line\">myObject[<span class=\"string\">\"[object Object]\"</span>]; <span class=\"comment\">// \"baz\"</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"可计算属性名\"><a href=\"#可计算属性名\" class=\"headerlink\" title=\"可计算属性名\"></a>可计算属性名</h4><p>ES6 增加了可计算属性名：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> prefix = <span class=\"string\">\"foo\"</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;</div><div class=\"line\">[prefix + <span class=\"string\">\"bar\"</span>]:<span class=\"string\">\"hello\"</span>,</div><div class=\"line\">[prefix + <span class=\"string\">\"baz\"</span>]: <span class=\"string\">\"world\"</span></div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">myObject[<span class=\"string\">\"foobar\"</span>]; <span class=\"comment\">// hello</span></div><div class=\"line\">myObject[<span class=\"string\">\"foobaz\"</span>]; <span class=\"comment\">// world</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h4><p>数组也是对象，所以虽然每个下标都是整数，你仍然可以给数组添加属性：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myArray = [ <span class=\"string\">\"foo\"</span>, <span class=\"number\">42</span>, <span class=\"string\">\"bar\"</span> ];</div><div class=\"line\">myArray.baz = <span class=\"string\">\"baz\"</span>;</div><div class=\"line\">myArray.length; <span class=\"comment\">// 3</span></div><div class=\"line\">myArray.baz; <span class=\"comment\">// \"baz\"</span></div></pre></td></tr></table></figure></p>\n<p>可以看到虽然添加了命名属性，数组的length值并未发生变化。完全可以把数组当作一个普通的键/值对象来使用，但这不是一个好选择。<br>当试图给数组添加一个数字字符串的属性名时，它会变成一个数值下标，注意与对象区别：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myArray = [ <span class=\"string\">\"foo\"</span>, <span class=\"number\">42</span>, <span class=\"string\">\"bar\"</span> ];</div><div class=\"line\">myArray[<span class=\"string\">\"3\"</span>] = <span class=\"string\">\"baz\"</span>;</div><div class=\"line\">myArray.length; <span class=\"comment\">// 4</span></div><div class=\"line\">myArray[<span class=\"number\">3</span>]; <span class=\"comment\">// \"baz\"</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"属性描述符\"><a href=\"#属性描述符\" class=\"headerlink\" title=\"属性描述符\"></a>属性描述符</h4><p>直接上代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>:<span class=\"number\">2</span></div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"built_in\">Object</span>.getOwnPropertyDescriptor( myObject, <span class=\"string\">\"a\"</span> );</div><div class=\"line\"><span class=\"comment\">// &#123;</span></div><div class=\"line\"><span class=\"comment\">// value: 2,</span></div><div class=\"line\"><span class=\"comment\">// writable: true,</span></div><div class=\"line\"><span class=\"comment\">// enumerable: true,</span></div><div class=\"line\"><span class=\"comment\">// configurable: true</span></div><div class=\"line\"><span class=\"comment\">// &#125;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;&#125;;</div><div class=\"line\"><span class=\"built_in\">Object</span>.defineProperty( myObject, <span class=\"string\">\"a\"</span>, &#123;</div><div class=\"line\">    <span class=\"attr\">value</span>: <span class=\"number\">2</span>,</div><div class=\"line\">    <span class=\"attr\">writable</span>: <span class=\"literal\">true</span>,</div><div class=\"line\">    <span class=\"attr\">configurable</span>: <span class=\"literal\">true</span>,</div><div class=\"line\">    <span class=\"attr\">enumerable</span>: <span class=\"literal\">true</span></div><div class=\"line\">&#125;);</div><div class=\"line\">myObject.a; <span class=\"comment\">// 2</span></div></pre></td></tr></table></figure></p>\n<p>writable和enumerable不用说，configurable为false时，就不能用<code>defineProperty()</code>方法来修改属性描述符，也不能用delete语句删除这个属性。这里有个小例外：即便属性是不可配置的，我们还是可以把是否可写状态由true改为false，不过无法由false改为true。</p>\n<h4 id=\"不变性\"><a href=\"#不变性\" class=\"headerlink\" title=\"不变性\"></a>不变性</h4><ol>\n<li><p>对象常量<br>结合<code>writable:false</code>和<code>configurable:false</code>就可以创建一个真正的常量属性（不可修改、重定义或删除）：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;&#125;;</div><div class=\"line\"><span class=\"built_in\">Object</span>.defineProperty( myObject, <span class=\"string\">\"FAVORITE_NUMBER\"</span>, &#123;</div><div class=\"line\">    <span class=\"attr\">value</span>: <span class=\"number\">42</span>,</div><div class=\"line\">    <span class=\"attr\">writable</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    <span class=\"attr\">configurable</span>: <span class=\"literal\">false</span></div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n</li>\n<li><p>禁止扩展<br>可以使用<code>Object.preventExtensions()</code>来禁止一个对象添加新属性：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>:<span class=\"number\">2</span></div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"built_in\">Object</span>.preventExtensions( myObject );</div><div class=\"line\">myObject.b = <span class=\"number\">3</span>;</div><div class=\"line\">myObject.b; <span class=\"comment\">// undefined</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>严格模式下会抛出错误。</p>\n<ol>\n<li>密封<br><code>Object.seal()</code>会创建一个“密封”对象，相当于<code>Object.preventExtensions() + configurable:false</code></li>\n<li>冻结<br><code>Object.freeze</code>会创建一个冻结对象，相当于<code>Object.seal() + writable:false</code>。冻结是可以用在一个对象上的级别最高的不可变性。<h4 id=\"Getter和Setter（访问描述符）\"><a href=\"#Getter和Setter（访问描述符）\" class=\"headerlink\" title=\"Getter和Setter（访问描述符）\"></a>Getter和Setter（访问描述符）</h4>直接上代码：<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;</div><div class=\"line\">    <span class=\"comment\">// 给a 定义一个getter</span></div><div class=\"line\">    get a() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"built_in\">Object</span>.defineProperty(</div><div class=\"line\">    myObject, <span class=\"comment\">// 目标对象</span></div><div class=\"line\">    <span class=\"string\">\"b\"</span>, <span class=\"comment\">// 属性名</span></div><div class=\"line\">    &#123; <span class=\"comment\">// 描述符</span></div><div class=\"line\">        <span class=\"comment\">// 给b 设置一个getter</span></div><div class=\"line\">        get: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123; <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.a * <span class=\"number\">2</span> &#125;,</div><div class=\"line\">        <span class=\"comment\">// 确保b 会出现在对象的属性列表中</span></div><div class=\"line\">        enumerable: <span class=\"literal\">true</span></div><div class=\"line\">    &#125;</div><div class=\"line\">);</div><div class=\"line\">myObject.a; <span class=\"comment\">// 2</span></div><div class=\"line\">myObject.b; <span class=\"comment\">// 4</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>setter同理，当只定义一个时，会忽略另一个操作，通常getter和setter是成对出现的，否则可能才产生意料之外的行为。</p>\n<h2 id=\"第4章-混合对象“类”\"><a href=\"#第4章-混合对象“类”\" class=\"headerlink\" title=\"第4章 混合对象“类”\"></a>第4章 混合对象“类”</h2><h3 id=\"混入\"><a href=\"#混入\" class=\"headerlink\" title=\"混入\"></a>混入</h3><h4 id=\"显示混入\"><a href=\"#显示混入\" class=\"headerlink\" title=\"显示混入\"></a>显示混入</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 非常简单的mixin()例子：</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">mixin</span>(<span class=\"params\">sourceObj, targetObj</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> sourceObj) &#123;</div><div class=\"line\">        <span class=\"comment\">// 只会在不存在的情况下复制 但也只是复制引用</span></div><div class=\"line\">        <span class=\"keyword\">if</span>(!(key <span class=\"keyword\">in</span> targetObj)) &#123;</div><div class=\"line\">            targetObj[key] = sourceObj[key];</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> targetObj;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> Vehicle = &#123;</div><div class=\"line\">    <span class=\"attr\">engines</span>: <span class=\"number\">1</span>,</div><div class=\"line\">    <span class=\"attr\">ignition</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Turning on my engine.\"</span>);</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">drive</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.ignition();</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">\"steering and moving forward!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> Car = mixin(Vehicle, &#123;</div><div class=\"line\">    <span class=\"attr\">wheels</span>: <span class=\"number\">4</span>,</div><div class=\"line\">    <span class=\"attr\">drive</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        Vehicle.drive.call(<span class=\"keyword\">this</span>);  <span class=\"comment\">// 显式多态</span></div><div class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Rolling on all \"</span> + <span class=\"keyword\">this</span>.wheels + <span class=\"string\">\" wheels!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>上面看似是很棒的机制，实际上并不能带来太多好处，要注意只在能提高代码可读性的前提下使用显示混入，避免使用增加代码理解难度或者让对象关系更加复杂的模式。</p>\n<h5 id=\"寄生继承\"><a href=\"#寄生继承\" class=\"headerlink\" title=\"寄生继承\"></a>寄生继承</h5><p>显示混入模式的一种变体，它既是显式的又是隐式的。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//\"传统的JavaScript类\"Vehicle</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Vehicle</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.engines = <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">Vehicle.prototype.ignition = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Turning on my engine.\"</span>);</div><div class=\"line\">&#125;;</div><div class=\"line\">vehicle.prototype.drive = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.ignition();</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Steering and moving forward!\"</span>);</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"comment\">//\"寄生类\"Car</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Car</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//首先，car是一个Vehicle</span></div><div class=\"line\">    <span class=\"keyword\">var</span> car = <span class=\"keyword\">new</span> Vehicle();</div><div class=\"line\">    <span class=\"comment\">//接着对car进行定制</span></div><div class=\"line\">    car.wheels = <span class=\"number\">4</span>;</div><div class=\"line\">    <span class=\"comment\">//保存到Vehicle::drive()的特殊引用</span></div><div class=\"line\">    <span class=\"keyword\">var</span> vehDrive = car.drive;</div><div class=\"line\">    <span class=\"comment\">//重写Vehicle::drive()</span></div><div class=\"line\">    car.drive = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        vehDrive.call(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Rolling on all \"</span> + <span class=\"keyword\">this</span>.wheels + <span class=\"string\">\" wheels!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> car;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> myCar = <span class=\"keyword\">new</span> Car();</div><div class=\"line\">myCar.drive();</div></pre></td></tr></table></figure></p>\n<h4 id=\"隐式混入\"><a href=\"#隐式混入\" class=\"headerlink\" title=\"隐式混入\"></a>隐式混入</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> Something = &#123;</div><div class=\"line\">    <span class=\"attr\">cool</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.greeting = <span class=\"string\">\"Hello World\"</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.count = <span class=\"keyword\">this</span>.count ? <span class=\"keyword\">this</span>.count + <span class=\"number\">1</span> : <span class=\"number\">1</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">Something.cool();</div><div class=\"line\">Something.greeting; <span class=\"comment\">// \"Hello World\"</span></div><div class=\"line\">Something.count; <span class=\"comment\">// 1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> Another = &#123;</div><div class=\"line\">    <span class=\"attr\">cool</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"comment\">// 隐式把Something 混入Another</span></div><div class=\"line\">        Something.cool.call( <span class=\"keyword\">this</span> );</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">Another.cool();</div><div class=\"line\">Another.greeting; <span class=\"comment\">// \"Hello World\"</span></div><div class=\"line\">Another.count; <span class=\"comment\">// 1 （count 不是共享状态）</span></div></pre></td></tr></table></figure>\n<p>这类技术虽利用了this的重新绑定功能，但不够灵活，通常来说，应尽量避免使用这样的结构，以保证代码的整洁和可维护性。</p>\n<h3 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p>混入模式虽可用来模拟类的复制行为，但通常会产生丑陋并且脆弱的语法，这会让代码更加难懂并且难以维护。况且JavaScript并不会像类一样创建对象的副本，只能复制引用。</p>\n<h2 id=\"第5章-原型\"><a href=\"#第5章-原型\" class=\"headerlink\" title=\"第5章 原型\"></a>第5章 原型</h2><h4 id=\"属性设置和屏蔽\"><a href=\"#属性设置和屏蔽\" class=\"headerlink\" title=\"属性设置和屏蔽\"></a>属性设置和屏蔽</h4><p>分析下面这个给一个对象设置属性的过程：<br><code>myObject.foo = &quot;bar&quot;;</code><br>如果myObject中包含foo的普通数据访问属性，这条赋值语句只会修改已有的属性值。<br>如果myObject中不存在foo，原型链上也找不到foo，foo就会被直接添加到myObject上。<br>如果foo既出现在myObject中也出现在myObject的原型链中，就会发生屏蔽。myObject 中包含的foo 属性会屏蔽原型链上层的所有foo 属性。<br>但是如果foo不直接存在与myObject中而是存在原型链上时，<code>myObject.foo = &quot;bar&quot;;</code>会出现三种情况：</p>\n<ol>\n<li>如果在原型链上存在名为foo 的普通数据访问属性，并且没有被标记为只读（writable:false），那就会直接在myObject 中添加一个名为foo 的新属性，它是屏蔽属性。</li>\n<li>如果在原型链上存在foo，但是它被标记为只读（writable:false），那么无法修改已有属性或者在myObject 上创建屏蔽属性。如果运行在严格模式下，代码会抛出一个错误。否则，这条赋值语句会被忽略。总之，不会发生屏蔽。</li>\n<li>如果在原型链上存在foo 并且它是一个setter，那就一定会调用这个setter。foo不会被添加到（或者说屏蔽于）myObject，也不会重新定义foo 这个setter。<br>只有第一种才会触发屏蔽，如果是第二、第三种就不能使用<code>=</code>来赋值了，就要使用<code>Object.defineProperty()</code>来向myObject添加foo.<br>一些情况会产生隐式屏蔽：<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> anotherObject = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>:<span class=\"number\">2</span></div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> myObject = <span class=\"built_in\">Object</span>.create( anotherObject );</div><div class=\"line\">anotherObject.a; <span class=\"comment\">// 2</span></div><div class=\"line\">myObject.a; <span class=\"comment\">// 2</span></div><div class=\"line\">anotherObject.hasOwnProperty( <span class=\"string\">\"a\"</span> ); <span class=\"comment\">// true</span></div><div class=\"line\">myObject.hasOwnProperty( <span class=\"string\">\"a\"</span> ); <span class=\"comment\">// false</span></div><div class=\"line\"></div><div class=\"line\">myObject.a++; <span class=\"comment\">// 隐式屏蔽！</span></div><div class=\"line\"></div><div class=\"line\">anotherObject.a; <span class=\"comment\">// 2</span></div><div class=\"line\">myObject.a; <span class=\"comment\">// 3</span></div><div class=\"line\"></div><div class=\"line\">myObject.hasOwnProperty( <span class=\"string\">\"a\"</span> ); <span class=\"comment\">// true</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><code>myObject.a++;</code>相当于<code>myObject.a = myObject.a + 1;</code>这样给myObject新建了屏蔽属性a！</p>\n<h3 id=\"“类”\"><a href=\"#“类”\" class=\"headerlink\" title=\"“类”\"></a>“类”</h3><h4 id=\"“构造函数”\"><a href=\"#“构造函数”\" class=\"headerlink\" title=\"“构造函数”\"></a>“构造函数”</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// ...</span></div><div class=\"line\">&#125;</div><div class=\"line\">Foo.prototype.constructor === Foo; <span class=\"comment\">// true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"keyword\">new</span> Foo();</div><div class=\"line\">a.constructor === Foo; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure>\n<p>Foo.prototype默认有一个共有并且不可枚举的属性<code>.constructor</code>,这个属性引用的是对象关联的函数（本例是Foo）。a本身并没有<code>.constructor</code>属性，只是委托给了Foo.prototype，这和“构造”毫无关系。对于<code>.constructor</code>的错误理解很容易对你自己产生误导。例：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Foo</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">/* .. */</span> &#125;</div><div class=\"line\">Foo.prototype = &#123; <span class=\"comment\">/* .. */</span> &#125;; <span class=\"comment\">// 创建一个新原型对象</span></div><div class=\"line\"><span class=\"keyword\">var</span> a1 = <span class=\"keyword\">new</span> Foo();</div><div class=\"line\">a1.constructor === Foo; <span class=\"comment\">// false!</span></div><div class=\"line\">a1.constructor === <span class=\"built_in\">Object</span>; <span class=\"comment\">// true!</span></div></pre></td></tr></table></figure></p>\n<p>Object()并没有“构造”a1，看起来应该是Foo()“构造”了它，这次的结果是因为Foo.prototype也没有<code>.constructor</code>属性，继续向上委托到了Object.prototype。<br>当然，此时可以给Foo.prototype通过Object.defineProperty添加一个不可枚举的<code>.constructor</code>属性来达到最开始的效果。</p>\n<h3 id=\"（原型）继承\"><a href=\"#（原型）继承\" class=\"headerlink\" title=\"（原型）继承\"></a>（原型）继承</h3><p>典型的“原型风格”：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Foo</span>(<span class=\"params\">name</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">&#125;</div><div class=\"line\">Foo.prototype.myName = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Bar</span>(<span class=\"params\">name,label</span>) </span>&#123;</div><div class=\"line\">    Foo.call( <span class=\"keyword\">this</span>, name );</div><div class=\"line\">    <span class=\"keyword\">this</span>.label = label;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 我们创建了一个新的Bar.prototype 对象并关联到Foo.prototype</span></div><div class=\"line\">Bar.prototype = <span class=\"built_in\">Object</span>.create( Foo.prototype );</div><div class=\"line\"><span class=\"comment\">// 注意！现在没有Bar.prototype.constructor 了</span></div><div class=\"line\"><span class=\"comment\">// 如果你需要这个属性的话可能需要手动修复一下它</span></div><div class=\"line\"></div><div class=\"line\">Bar.prototype.myLabel = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.label;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"keyword\">new</span> Bar( <span class=\"string\">\"a\"</span>, <span class=\"string\">\"obj a\"</span> );</div><div class=\"line\">a.myName(); <span class=\"comment\">// \"a\"</span></div><div class=\"line\">a.myLabel(); <span class=\"comment\">// \"obj a\"</span></div></pre></td></tr></table></figure></p>\n<p>上面代码的核心部分就是语句<code>Bar.prototype = Object.create(Foo.prototype)</code>。调用<code>Object.create()</code>会凭空创建一个“新”对象并把新对象内部的原型关联到你指定的对象（本例中是Foo.prototype）。ES6新增了一种方法：<code>Object.setPrototypeOf( Bar.prototype, Foo.prototype );</code>也可以实现。</p>\n<h4 id=\"检查“类”关系\"><a href=\"#检查“类”关系\" class=\"headerlink\" title=\"检查“类”关系\"></a>检查“类”关系</h4><p>检查一个实例（JavaScript中的对象）的继承祖先（JavaScript中的委托关联）通常被称为内省（或者反射）。<br><code>b.isPrototypeOf( c );</code>b是否出现在c的原型链中。也可以直接获取一个对象的原型链<code>Object.getPrototypeOf( a );</code>。<code>.__proto__</code>引用了对象的原型对象，在ES6中也成为了标准。</p>\n<h3 id=\"对象关联\"><a href=\"#对象关联\" class=\"headerlink\" title=\"对象关联\"></a>对象关联</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> anotherObject = &#123;</div><div class=\"line\">    <span class=\"attr\">a</span>:<span class=\"number\">2</span></div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> myObject = <span class=\"built_in\">Object</span>.create( anotherObject, &#123;</div><div class=\"line\">    <span class=\"attr\">b</span>: &#123;</div><div class=\"line\">    <span class=\"attr\">enumerable</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    <span class=\"attr\">writable</span>: <span class=\"literal\">true</span>,</div><div class=\"line\">    <span class=\"attr\">configurable</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    <span class=\"attr\">value</span>: <span class=\"number\">3</span></div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">c</span>: &#123;</div><div class=\"line\">    <span class=\"attr\">enumerable</span>: <span class=\"literal\">true</span>,</div><div class=\"line\">    <span class=\"attr\">writable</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    <span class=\"attr\">configurable</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    <span class=\"attr\">value</span>: <span class=\"number\">4</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\">myObject.hasOwnProperty( <span class=\"string\">\"a\"</span> ); <span class=\"comment\">// false</span></div><div class=\"line\">myObject.hasOwnProperty( <span class=\"string\">\"b\"</span> ); <span class=\"comment\">// true</span></div><div class=\"line\">myObject.hasOwnProperty( <span class=\"string\">\"c\"</span> ); <span class=\"comment\">// true</span></div><div class=\"line\"></div><div class=\"line\">myObject.a; <span class=\"comment\">// 2</span></div><div class=\"line\">myObject.b; <span class=\"comment\">// 3</span></div><div class=\"line\">myObject.c; <span class=\"comment\">// 4</span></div></pre></td></tr></table></figure>\n<p>为了使代码更具可读性，更易维护，推荐使用内部委托：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> anotherObject = &#123;</div><div class=\"line\">    <span class=\"attr\">cool</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log( <span class=\"string\">\"cool!\"</span> );</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> myObject = <span class=\"built_in\">Object</span>.create( anotherObject );</div><div class=\"line\">myObject.doCool = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.cool(); <span class=\"comment\">// 内部委托！</span></div><div class=\"line\">&#125;;</div><div class=\"line\">myObject.doCool(); <span class=\"comment\">// \"cool!\"</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"第6章-行为委托\"><a href=\"#第6章-行为委托\" class=\"headerlink\" title=\"第6章 行为委托\"></a>第6章 行为委托</h2><h4 id=\"委托理论\"><a href=\"#委托理论\" class=\"headerlink\" title=\"委托理论\"></a>委托理论</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">Task = &#123;</div><div class=\"line\">    <span class=\"attr\">setID</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ID</span>) </span>&#123; <span class=\"keyword\">this</span>.id = ID; &#125;,</div><div class=\"line\">    <span class=\"attr\">outputID</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"built_in\">console</span>.log( <span class=\"keyword\">this</span>.id ); &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"comment\">// 让XYZ 委托Task</span></div><div class=\"line\">XYZ = <span class=\"built_in\">Object</span>.create( Task );</div><div class=\"line\">XYZ.prepareTask = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ID,Label</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.setID( ID );</div><div class=\"line\">    <span class=\"keyword\">this</span>.label = Label;</div><div class=\"line\">&#125;;</div><div class=\"line\">XYZ.outputTaskDetails = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.outputID();</div><div class=\"line\">    <span class=\"built_in\">console</span>.log( <span class=\"keyword\">this</span>.label );</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"comment\">// ABC = Object.create( Task );</span></div><div class=\"line\"><span class=\"comment\">// ABC ... = ...</span></div></pre></td></tr></table></figure>\n<p>通常来说，在原型委托中最好把状态保存在委托者（XYZ、ABC）而不是委托目标（Task）上。尽量避免在原型链的不同级别中使用相同的命名，用以消除引用歧义。委托行为意味着某些对象（XYZ）在找不到属性或者方法引用时会把这个请求委托给另一个对象（Task）。要禁止互相委托。</p>\n<h4 id=\"比较思维模型\"><a href=\"#比较思维模型\" class=\"headerlink\" title=\"比较思维模型\"></a>比较思维模型</h4><p>典型的（“原型”）面向对象风格：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Foo</span>(<span class=\"params\">who</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.me = who;</div><div class=\"line\">&#125;</div><div class=\"line\">Foo.prototype.identify = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"I am \"</span> + <span class=\"keyword\">this</span>.me;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Bar</span>(<span class=\"params\">who</span>) </span>&#123;</div><div class=\"line\">    Foo.call( <span class=\"keyword\">this</span>, who );</div><div class=\"line\">&#125;</div><div class=\"line\">Bar.prototype = <span class=\"built_in\">Object</span>.create( Foo.prototype );</div><div class=\"line\">Bar.prototype.speak = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert( <span class=\"string\">\"Hello, \"</span> + <span class=\"keyword\">this</span>.identify() + <span class=\"string\">\".\"</span> );</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> b1 = <span class=\"keyword\">new</span> Bar( <span class=\"string\">\"b1\"</span> );</div><div class=\"line\"><span class=\"keyword\">var</span> b2 = <span class=\"keyword\">new</span> Bar( <span class=\"string\">\"b2\"</span> );</div><div class=\"line\">b1.speak();</div><div class=\"line\">b2.speak();</div></pre></td></tr></table></figure></p>\n<p>对象关联风格实现功能完全相同的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">Foo = &#123;</div><div class=\"line\">    <span class=\"attr\">init</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">who</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.me = who;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">identify</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"I am \"</span> + <span class=\"keyword\">this</span>.me;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">Bar = <span class=\"built_in\">Object</span>.create( Foo );</div><div class=\"line\">Bar.speak = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert( <span class=\"string\">\"Hello, \"</span> + <span class=\"keyword\">this</span>.identify() + <span class=\"string\">\".\"</span> );</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> b1 = <span class=\"built_in\">Object</span>.create( Bar );</div><div class=\"line\">b1.init( <span class=\"string\">\"b1\"</span> );</div><div class=\"line\"><span class=\"keyword\">var</span> b2 = <span class=\"built_in\">Object</span>.create( Bar );</div><div class=\"line\">b2.init( <span class=\"string\">\"b2\"</span> );</div><div class=\"line\">b1.speak();</div><div class=\"line\">b2.speak();</div></pre></td></tr></table></figure></p>\n<h3 id=\"类与对象\"><a href=\"#类与对象\" class=\"headerlink\" title=\"类与对象\"></a>类与对象</h3><p>ES5实现类风格的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 父类</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Widget</span>(<span class=\"params\">width,height</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.width = width || <span class=\"number\">50</span>;</div><div class=\"line\">    <span class=\"keyword\">this</span>.height = height || <span class=\"number\">50</span>;</div><div class=\"line\">    <span class=\"keyword\">this</span>.$elem = <span class=\"literal\">null</span>;</div><div class=\"line\">&#125;</div><div class=\"line\">Widget.prototype.render = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$where</span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.$elem) &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.$elem.css( &#123;</div><div class=\"line\">            <span class=\"attr\">width</span>: <span class=\"keyword\">this</span>.width + <span class=\"string\">\"px\"</span>,</div><div class=\"line\">            <span class=\"attr\">height</span>: <span class=\"keyword\">this</span>.height + <span class=\"string\">\"px\"</span></div><div class=\"line\">        &#125; ).appendTo( $where );</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 子类</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Button</span>(<span class=\"params\">width,height,label</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 调用“super”构造函数</span></div><div class=\"line\">    Widget.call( <span class=\"keyword\">this</span>, width, height );</div><div class=\"line\">    <span class=\"keyword\">this</span>.label = label || <span class=\"string\">\"Default\"</span>;</div><div class=\"line\">    <span class=\"keyword\">this</span>.$elem = $( <span class=\"string\">\"&lt;button&gt;\"</span> ).text( <span class=\"keyword\">this</span>.label );</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">// 让Button“继承”Widget</span></div><div class=\"line\">Button.prototype = <span class=\"built_in\">Object</span>.create( Widget.prototype );</div><div class=\"line\"><span class=\"comment\">// 重写render(..)</span></div><div class=\"line\">Button.prototype.render = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$where</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// “super”调用</span></div><div class=\"line\">    Widget.prototype.render.call( <span class=\"keyword\">this</span>, $where );</div><div class=\"line\">    <span class=\"keyword\">this</span>.$elem.click( <span class=\"keyword\">this</span>.onClick.bind( <span class=\"keyword\">this</span> ) );</div><div class=\"line\">&#125;;</div><div class=\"line\">Button.prototype.onClick = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log( <span class=\"string\">\"Button '\"</span> + <span class=\"keyword\">this</span>.label + <span class=\"string\">\"' clicked!\"</span> );</div><div class=\"line\">&#125;;</div><div class=\"line\">$( <span class=\"built_in\">document</span> ).ready( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> $body = $( <span class=\"built_in\">document</span>.body );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn1 = <span class=\"keyword\">new</span> Button( <span class=\"number\">125</span>, <span class=\"number\">30</span>, <span class=\"string\">\"Hello\"</span> );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn2 = <span class=\"keyword\">new</span> Button( <span class=\"number\">150</span>, <span class=\"number\">40</span>, <span class=\"string\">\"World\"</span> );</div><div class=\"line\">    btn1.render( $body );</div><div class=\"line\">    btn2.render( $body );</div><div class=\"line\">&#125; );</div></pre></td></tr></table></figure></p>\n<p>代码中丑陋的显式伪多态<code>Widget.call</code>和<code>Widget.prototype.render.call</code>。<br>使用ES6的class语法糖实现的功能相同的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Widget</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(width,height) &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.width = width || <span class=\"number\">50</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.height = height || <span class=\"number\">50</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.$elem = <span class=\"literal\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    render($where)&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.$elem) &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.$elem.css( &#123;</div><div class=\"line\">                <span class=\"attr\">width</span>: <span class=\"keyword\">this</span>.width + <span class=\"string\">\"px\"</span>,</div><div class=\"line\">                <span class=\"attr\">height</span>: <span class=\"keyword\">this</span>.height + <span class=\"string\">\"px\"</span></div><div class=\"line\">            &#125; ).appendTo( $where );</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Button</span> <span class=\"keyword\">extends</span> <span class=\"title\">Widget</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(width,height,label) &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>( width, height );</div><div class=\"line\">        <span class=\"keyword\">this</span>.label = label || <span class=\"string\">\"Default\"</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.$elem = $( <span class=\"string\">\"&lt;button&gt;\"</span> ).text( <span class=\"keyword\">this</span>.label );</div><div class=\"line\">    &#125;</div><div class=\"line\">    render($where) &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>( $where );</div><div class=\"line\">        <span class=\"keyword\">this</span>.$elem.click( <span class=\"keyword\">this</span>.onClick.bind( <span class=\"keyword\">this</span> ) );</div><div class=\"line\">    &#125;</div><div class=\"line\">    onClick(evt) &#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log( <span class=\"string\">\"Button '\"</span> + <span class=\"keyword\">this</span>.label + <span class=\"string\">\"' clicked!\"</span> );</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\">$( <span class=\"built_in\">document</span> ).ready( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> $body = $( <span class=\"built_in\">document</span>.body );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn1 = <span class=\"keyword\">new</span> Button( <span class=\"number\">125</span>, <span class=\"number\">30</span>, <span class=\"string\">\"Hello\"</span> );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn2 = <span class=\"keyword\">new</span> Button( <span class=\"number\">150</span>, <span class=\"number\">40</span>, <span class=\"string\">\"World\"</span> );</div><div class=\"line\">    btn1.render( $body );</div><div class=\"line\">    btn2.render( $body );</div><div class=\"line\">&#125; );</div></pre></td></tr></table></figure></p>\n<p>丑陋的语法都不见了，非常棒。<br>使用对象关联风格委托来实现功能相同的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> Widget = &#123;</div><div class=\"line\">    <span class=\"attr\">init</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">width,height</span>)</span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.width = width || <span class=\"number\">50</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.height = height || <span class=\"number\">50</span>;</div><div class=\"line\">        <span class=\"keyword\">this</span>.$elem = <span class=\"literal\">null</span>;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">insert</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$where</span>)</span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.$elem) &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.$elem.css( &#123;</div><div class=\"line\">                <span class=\"attr\">width</span>: <span class=\"keyword\">this</span>.width + <span class=\"string\">\"px\"</span>,</div><div class=\"line\">                <span class=\"attr\">height</span>: <span class=\"keyword\">this</span>.height + <span class=\"string\">\"px\"</span></div><div class=\"line\">            &#125; ).appendTo( $where );</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> Button = <span class=\"built_in\">Object</span>.create( Widget );</div><div class=\"line\">Button.setup = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">width,height,label</span>)</span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 委托调用</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.init( width, height );</div><div class=\"line\">    <span class=\"keyword\">this</span>.label = label || <span class=\"string\">\"Default\"</span>;</div><div class=\"line\">    <span class=\"keyword\">this</span>.$elem = $( <span class=\"string\">\"&lt;button&gt;\"</span> ).text( <span class=\"keyword\">this</span>.label );</div><div class=\"line\">&#125;;</div><div class=\"line\">Button.build = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$where</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 委托调用</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.insert( $where );</div><div class=\"line\">    <span class=\"keyword\">this</span>.$elem.click( <span class=\"keyword\">this</span>.onClick.bind( <span class=\"keyword\">this</span> ) );</div><div class=\"line\">&#125;;</div><div class=\"line\">Button.onClick = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log( <span class=\"string\">\"Button '\"</span> + <span class=\"keyword\">this</span>.label + <span class=\"string\">\"' clicked!\"</span> );</div><div class=\"line\">&#125;;</div><div class=\"line\">$( <span class=\"built_in\">document</span> ).ready( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> $body = $( <span class=\"built_in\">document</span>.body );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn1 = <span class=\"built_in\">Object</span>.create( Button );</div><div class=\"line\">    btn1.setup( <span class=\"number\">125</span>, <span class=\"number\">30</span>, <span class=\"string\">\"Hello\"</span> );</div><div class=\"line\">    <span class=\"keyword\">var</span> btn2 = <span class=\"built_in\">Object</span>.create( Button );</div><div class=\"line\">    btn2.setup( <span class=\"number\">150</span>, <span class=\"number\">40</span>, <span class=\"string\">\"World\"</span> );</div><div class=\"line\">    btn1.build( $body );</div><div class=\"line\">    btn2.build( $body );</div><div class=\"line\">&#125; );</div></pre></td></tr></table></figure></p>\n<p>之前的一次调用变成了两次，需要初始化。这看似是个缺点，实则更好地支持关注分离原则，更灵活了。</p>\n<h3 id=\"更好地语法\"><a href=\"#更好地语法\" class=\"headerlink\" title=\"更好地语法\"></a>更好地语法</h3><p>ES6的class语法可以简洁地定义类方法，ES6中也可以在任意对象的字面量形式中使用简洁方法声明，唯一的区别是对象的字面量形式仍然需要使用逗号来分隔元素，而class语法不需要。不过有一个小缺点：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> Foo = &#123;</div><div class=\"line\">    bar() &#123; <span class=\"comment\">/*..*/</span> &#125;,</div><div class=\"line\">    <span class=\"attr\">baz</span>: <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">baz</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">/*..*/</span> &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>去掉语法糖之后的代码如下：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> Foo = &#123;</div><div class=\"line\">    <span class=\"attr\">bar</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">/*..*/</span> &#125;,</div><div class=\"line\">    <span class=\"attr\">baz</span>: <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">baz</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">/*..*/</span> &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>简洁形式的声明最终会变成一个匿名函数表达式，这样自我引用（递归、事件（解除）绑定、等等）更难。</p>\n<h3 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p>本章中我们看到了另一种更少见但是更强大的设计模式：行为委托。对象关联（对象之前互相关联）是一种编码风格，它倡导的是直接创建和关联对象，不把它们抽象成类。对象关联可以用基于原型的行为委托非常自然地实现。</p>\n<h2 id=\"附录A-ES6中的Class\"><a href=\"#附录A-ES6中的Class\" class=\"headerlink\" title=\"附录A ES6中的Class\"></a>附录A ES6中的Class</h2><p>class语法很好的解决了一些典型原型风格代码中的许多显而易见的语法问题和缺点，但它毕竟不是新的类机制，只是现有原型机制的一种语法糖，自然有许多缺点没有解决或者新暴露了出来。</p>\n<h3 id=\"class陷阱\"><a href=\"#class陷阱\" class=\"headerlink\" title=\"class陷阱\"></a>class陷阱</h3><p>class语法无法定义类成员属性（只能定义方法），这其实是把双刃剑，好处是原型链末端的“实例”不会意外地获取其他地方的属性（这些属性隐式被所有“实例”所共享），但缺点就是如果要跟踪“实例”之间的共享状态，且必须要这么做，就只能使用丑陋的<code>.prototype</code>语法：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">c</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>() &#123;</div><div class=\"line\">        <span class=\"comment\">// 确保修改的是共享状态而不是在实例上创建一个屏蔽属性！</span></div><div class=\"line\">        c.prototype.count++;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// this.count 可以通过委托实现我们想要的功能</span></div><div class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Hello: \"</span> + <span class=\"keyword\">this</span>.count);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">// 直接向prototype对象上添加一个共享状态</span></div><div class=\"line\">C.prototype.count = <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> c1 = <span class=\"keyword\">new</span> C(); <span class=\"comment\">// Hello: 1</span></div><div class=\"line\"><span class=\"keyword\">var</span> c2 = <span class=\"keyword\">new</span> C(); <span class=\"comment\">// Hello: 2</span></div><div class=\"line\"></div><div class=\"line\">c1.count === <span class=\"number\">2</span>; <span class=\"comment\">// true</span></div><div class=\"line\">c1.count === c2.count; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p>这个方法最大的问题就是违背了class语法的本意，在实现中暴露了<code>.prototype</code>。<br>此外，class语法仍勉励意外屏蔽的问题：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">C</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(id) &#123;</div><div class=\"line\">        <span class=\"comment\">// 噢，郁闷，我们的id 属性屏蔽了id() 方法</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.id = id;</div><div class=\"line\">    &#125;</div><div class=\"line\">    id() &#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log( <span class=\"string\">\"Id: \"</span> + id );</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> c1 = <span class=\"keyword\">new</span> C( <span class=\"string\">\"c1\"</span> );</div><div class=\"line\">c1.id(); <span class=\"comment\">// TypeError -- c1.id 现在是字符串\"c1\"</span></div></pre></td></tr></table></figure></p>\n<p>除此之外，super也存在一些细微的问题，处于性能考虑，super并不是动态绑定的，它会在声明时“静态”绑定。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">P</span> </span>&#123;</div><div class=\"line\">    foo() &#123; <span class=\"built_in\">console</span>.log( <span class=\"string\">\"P.foo\"</span> ); &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">C</span> <span class=\"keyword\">extends</span> <span class=\"title\">P</span> </span>&#123;</div><div class=\"line\">    foo() &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> c1 = <span class=\"keyword\">new</span> C();</div><div class=\"line\">c1.foo(); <span class=\"comment\">// \"P.foo\"</span></div><div class=\"line\"><span class=\"keyword\">var</span> D = &#123;</div><div class=\"line\">    <span class=\"attr\">foo</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"built_in\">console</span>.log( <span class=\"string\">\"D.foo\"</span> ); &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> E = &#123;</div><div class=\"line\">    <span class=\"attr\">foo</span>: C.prototype.foo</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 把E 委托到D</span></div><div class=\"line\"><span class=\"built_in\">Object</span>.setPrototypeOf( E, D );</div><div class=\"line\">E.foo(); <span class=\"comment\">// \"P.foo\"</span></div></pre></td></tr></table></figure></p>\n<p>大家可能期望super()会自动识别出E委托了D，所以E.foo()中的super()应该调用D.foo()，但实际并不是这样！这里只能手动修改super绑定：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> D = &#123;</div><div class=\"line\">    <span class=\"attr\">foo</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"built_in\">console</span>.log( <span class=\"string\">\"D.foo\"</span> ); &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"comment\">// 把E 委托到 D</span></div><div class=\"line\"><span class=\"keyword\">var</span> E = <span class=\"built_in\">Object</span>.create( D );</div><div class=\"line\"><span class=\"comment\">// 手动把foo 的[[HomeObject]] 绑定到E，E.[[Prototype]] 是D， 所以 super() 是D.foo()</span></div><div class=\"line\">E.foo = C.prototype.foo.toMethod( E, <span class=\"string\">\"foo\"</span> );</div><div class=\"line\">E.foo(); <span class=\"comment\">// \"D.foo\"</span></div></pre></td></tr></table></figure></p>\n<p>toMethod(..) 会复制方法并把homeObject 当作第一个参数（也就是我们传入的E），第二个参数（可选）是新方法的名称（默认是原方法名）。</p>\n<hr>\n<p>以上总结的知识要点只是现阶段我认为对我价值最大的部分，我略去了其中相当篇幅的我不感兴趣的还有暂时对我用处不大的部分，做这个总结不是为了将原书抛掉，只是想更精炼的提纯，提纯过程中对知识的再吸收，组织化。也方便之后的复习，提取。原书则退居到了字典的地位，时不时的翻翻目录，找找线索，待意外需要时取用便可以了。</p>\n","categories":["js"],"tags":["学习笔记"]},{"title":"思想、行为和结果互为解释","url":"http://charles-hang.github.io/2017/03/20/think-ideaActionResult/","content":"<p>人们总会说一个人他是怎么想的就会怎么做，他的行动反应了他的想法。我想说这个说法其实非常片面，人们思想和行为之间的关系可能非常的微妙。<br>人们为某个行动做决策的方式有两种，有意识的理性决策和无意识的感性决策。理性决策缓慢，讲究分析性。但如果人们做每个决策时都十分理性，那这样效率太低了，消耗太大了。所以有很多决策我们都是靠着感觉，下意识的行为，比如对即将遇到的危险的下意识躲避，一个人情绪激动而做出的事后都非常后悔的偏激行为等。这里我们仅讨论人们进过深思熟虑而做出的理性行为。人们怎么想就会怎么做，这个观点大家都知道，再正常不过了。但是我们可能低估了思想的力量。<br>有这样一个很著名的实验：某一学校对某个班级的学生进行了天赋等级划分，分高中低三档，这个划分完全是按照随机法来分的。并告诉他们的老师，老师们并不知道是随机分的。实验结束后，天赋“高”的一组学生的平均提高成绩是全班同学的平均提高成绩的两倍以上。“高”天赋组中的其实并不聪明的学生即使开始变现的不好，但老师们会认为他是有潜力的，只是需要耐心教导，最后他的表现也会不差。“低”天赋组的学生可真就倒霉了，哪怕其中有再聪明的学生，老师不重视，不关心，结果自然好不到哪去。<br>一个人你认为他是什么人，最终他可能真的就是什么人。实验中的老师对天赋“高”的学生寄予厚望，投入心血，最终就是换来了预期的效果。也就是，你有这么一个思想，你就会用这个思想指导你的行为，这个行为最后产生的结果很可能就是你想要的。<br>当人们的思想和他们做的行为矛盾的时候，会极其的不适，会难以容忍两者的背离。人们会想方设法的找个理由来解释自己的行为，这时他原先的想法就会被这个新的理由所改变。举个例子，一个婚姻中，男方原先是个非常痛恨动手打女人的男人的人，但夫妻有矛盾是非常正常的，一旦有一次男方情绪激动没忍住动手打了女方。他的想法会马上动摇，他一定会千方百计找个理由解释自己的行为，不为别的首先要说服自己。慢慢的不用多说，这个男的最后可能不会那么痛恨动手打女人的行为了，他会认为这个行为是有理由的。<br>在《蜥蜴脑法则》这本教人们怎么进行说服行为的书里提到一个观点：当你要说服一个人时，要以行为而非态度作为说服的目标，态度思想是很难被说服的，但行动是比较容易被说服的。当情绪、环境改变时，行为就会改变，行为改变态度思想自然就会改变。举个例子，你要追求一位女子，如果她一开始不喜欢你，你要做的不是靠嘴巴说服让她喜欢上你。而是想办法不断制造一个环境，让她和你做看似是情侣之间的事，比如一起看个电影，吃个饭什么的。慢慢地，她都会怀疑她自己是不是真的不喜欢你，她不会喜欢这种矛盾的感觉，很可能她内心已经说服自己喜欢上你了。这个结果不正是你想要的吗？<br>思想、行为和结果三者的关系可以形成一个正反馈，这个反馈中，三者相互促进，相互影响，互为解释。这让我非常兴奋，我们是不是可以利用这样一个正反馈，达到自己想要的某个结果，哪怕这个结果非常难实现，但只要我们在这个正反馈中，我们就会朝着想要的结果走下去，最终这个目标可能不会实现，但是结果一定不会让我们失望。想想现在我要做的第一件事应该就是“盲目地”自信，相信自己的能力，相信目标一定能实现。只要我获得了这个思想的小火苗，让它指导我的行为，进入这个正反馈中。剩下的事就是耐心，有毅力地看着它，看着它慢慢变大，最终形成燎原之势！</p>\n","categories":[],"tags":["感想"]},{"title":"[读书笔记]认知盈余","url":"http://charles-hang.github.io/2016/10/03/rn-cogSurplus/","content":"<p><img src=\"http://charles-hang.github.io/images/16_10_3/1.png\" alt=\"cognitive surplus\"></p>\n<h1 id=\"认知盈余\"><a href=\"#认知盈余\" class=\"headerlink\" title=\"认知盈余\"></a>认知盈余</h1><h2 id=\"第一章-当自由时间积累成认知盈余\"><a href=\"#第一章-当自由时间积累成认知盈余\" class=\"headerlink\" title=\"第一章 当自由时间积累成认知盈余\"></a>第一章 当自由时间积累成认知盈余</h2><p>十八世纪初，伦敦城市工业化带来的恐惧导致了人们对杜松子酒的疯狂消费，随着恐惧的减轻，人口数量和社会总财富的增长使得一种工业化的副产品————公民盈余出现了。人们寿命越来越长，工作时间越来越短，大量的自由时间产生了。而这大量的自由时间渐渐地被电视上播出的各种节目消磨掉了。人类是社会性动物，但自由时间的激增和某种社会资产的稳步减少趋于一致，这种社会资产便是人与人之间的信任与依靠。对电视的投入占用了人们陪家人和朋友的时间。在这个不平凡的时代，我们应把自由时间当做一种普遍的社会资产，用于大型的共同创造的项目，维基百科就是个例子。</p>\n<h3 id=\"奶昔错误\"><a href=\"#奶昔错误\" class=\"headerlink\" title=\"奶昔错误\"></a>奶昔错误</h3><p>摆脱根深蒂固的传统，跳出工具本身，人类的欲望推动了事物的发展。只要通过一种让他人在意的方式来充分利用认知盈余，那么他人也恢复制你的技术，传遍世界。</p>\n<h3 id=\"多即是不同\"><a href=\"#多即是不同\" class=\"headerlink\" title=\"多即是不同\"></a>多即是不同</h3><p>参与是一种行为，它让你觉得自己的出席很重要，让你在看到或听到某些东西时觉得自己的回应也是活动的一部分。我们应该同心协力贡献自己的空余时间来创造认知盈余，而不仅仅是完成一系列微不足道而有彼此分离的个人行为。当群体足够大时，不可预知的可以变得可预知。任何人类活动，无论看上去多么不可能，在人群中发生的可能性都会增加。规模较大的盈余和小盈余就是不同。</p>\n<h3 id=\"认知盈余，一种全新的资源\"><a href=\"#认知盈余，一种全新的资源\" class=\"headerlink\" title=\"认知盈余，一种全新的资源\"></a>认知盈余，一种全新的资源</h3><p>我们能够利用认知盈余的两个最重要转变已经产生：全球受教育人口累积起来的每年超过一万亿小时的自由时间和公共媒介的发明和扩散。</p>\n<h2 id=\"第二章-工具赋予的可能性\"><a href=\"#第二章-工具赋予的可能性\" class=\"headerlink\" title=\"第二章 工具赋予的可能性\"></a>第二章 工具赋予的可能性</h2><p>基于东方神起的社交网站而自发组织的游行抗议活动对韩国政府关于美国牛肉的政策产生了巨大影响。社会化媒体已经成为现实生活的一部分，抗议者们通过共享的同一媒体而凝结成了一股异常强大的力量。不仅社会化媒体在崭新的族群————也就是我们的手中有了新的一面，当沟通工具掌握在新的族群手中时，也会呈现出新的特点。</p>\n<h3 id=\"新方法，解决老问题\"><a href=\"#新方法，解决老问题\" class=\"headerlink\" title=\"新方法，解决老问题\"></a>新方法，解决老问题</h3><p>合伙搭车网站PickupPal将过剩的汽车和驾驶员重新整合，把他们当做潜在的共享资源。它创造了集合价值————用户越多，匹配的可能性就越大。有效解决了交通拥堵的问题，是社会化媒体作为现实社会一部分而真实存在，同时又在改进而不是脱离现实的一个例子。</p>\n<h3 id=\"古登堡经济原理或许不适用了\"><a href=\"#古登堡经济原理或许不适用了\" class=\"headerlink\" title=\"古登堡经济原理或许不适用了\"></a>古登堡经济原理或许不适用了</h3><p>活字印刷术的大大解放了书籍的传播，但来了新的问题：出版新书的经济风险。这就使印刷商、出版商同时还要为书的质量负责，在这个领域几乎所有的媒体都是由专业人士创作的，直到几年前我们还一直生活在这样的环境里。</p>\n<h3 id=\"只需要按一下“发表”的按钮\"><a href=\"#只需要按一下“发表”的按钮\" class=\"headerlink\" title=\"只需要按一下“发表”的按钮\"></a>只需要按一下“发表”的按钮</h3><p>以前，发表文章、出版书籍的过程极其困难复杂且开销极大。现在要做的就是打字，然后点击“发表”按钮。自由和品质构成了两种相互矛盾的目标，出版自由度的增加确实降低了出版物的平均水平，这就需要人们提高甄选水平，以防被淹没在一大堆不断降低品味的垃圾中。但是，某一领域的成本降低意味着可以开展更多的实验，交流成本的降低意味着可以开展更多关于思维和表达的实验。只有对新事物进行不断地尝试，才能创造出越来越好的作品，尽管随之也出现了大堆垃圾。</p>\n<h3 id=\"媒体，社会的连接组织\"><a href=\"#媒体，社会的连接组织\" class=\"headerlink\" title=\"媒体，社会的连接组织\"></a>媒体，社会的连接组织</h3><p>我们不仅在消费媒体，更是在利用媒体。旧有的捆绑在“媒体”这个词身上的诸多概念正在解体，比如“某种由专业人士创造的供业余人士消费的东西”的概念。媒体是社会的连接组织，公共媒体（如以小组专业人士制作的视觉信息或印制的传播信息）和个人媒体（如普通人的信件或电话）已经融合在一起了。原本只能在单向公共媒体和双向个人媒体间进行的选择，如今扩展除了第三个选项：从个人到公众的可延展的双向媒体操作。</p>\n<h3 id=\"做“酒吧”里的业余人士\"><a href=\"#做“酒吧”里的业余人士\" class=\"headerlink\" title=\"做“酒吧”里的业余人士\"></a>做“酒吧”里的业余人士</h3><p>我们在使用一个专业媒体的概念来指代种种业余人士的行为，而非专业媒体人的出发点和专业人士有着本质上的不同。业余人士不是专业人士的缩小版，他们有时乐于因金钱以外的原因而去做一些事。市场的作用之一就是为我们在市场之外所专注投入的事情提供平台，这个平台的形式可以是酒吧，也可以是网站。“数字化佃农”的逻辑有时不再适用。</p>\n<h3 id=\"工具，赋予我们行为发生的可能\"><a href=\"#工具，赋予我们行为发生的可能\" class=\"headerlink\" title=\"工具，赋予我们行为发生的可能\"></a>工具，赋予我们行为发生的可能</h3><p>多年来人类少有动机上的变化，但是机会总是随着社会环境或多过少发生着变化。在机会变化小的世界里，行为的变化也就很小，但当机会有了大的变动，行为也会随之变化，只要这个机会诉诸了人类的真实动机。对认知盈余的利用使人们得以用更慷慨、更公开、更加社会化的方式来表现自己，并不是我们的工具塑造了我们的行为，但是工具赋予了我们行为发生的可能。</p>\n<h2 id=\"第三章-无酬的动机\"><a href=\"#第三章-无酬的动机\" class=\"headerlink\" title=\"第三章 无酬的动机\"></a>第三章 无酬的动机</h2><p>经营“葛洛班之友慈善组织” 是一项艰巨的工作，参与者不仅没有报酬，还会搭上自己的钱，是什么促使人们为了没有明显回报的东西放弃自己的时间和金钱呢？</p>\n<h3 id=\"热爱胜于金钱\"><a href=\"#热爱胜于金钱\" class=\"headerlink\" title=\"热爱胜于金钱\"></a>热爱胜于金钱</h3><p>“自由选择”测试中，当某人能控制自己的行为时，他有多大的可能会表现出一种特定的行为？人类的动机并不纯粹是附加性的，为了兴趣而做事和为了报酬而做事是截然不同的。内在动机能让行为本身就成为一种回报，而对外在动机来说，回报来自于行为之外，而不在于行为本身。外在动机并不总是最有效的动机，增大外在动机实际上可能降低内在动机。当钱被用来作为志愿行为的回报时，它会降低志愿者贡献的平均劳动时间。出发点是兴趣还是金钱，会让人们在做事时表现得不一样。</p>\n<h3 id=\"自治和胜任感\"><a href=\"#自治和胜任感\" class=\"headerlink\" title=\"自治和胜任感\"></a>自治和胜任感</h3><p>内在动机是一张包罗万象的标签，把人们可能从一项活动中获得的或基于活动本身的回报所造成的各种激励因素聚集在一起。个人的内在动机包括：自治的愿望（指决定我们做什么，怎么做）和有胜任感的愿望（指能够胜任我们所做的事）。胜任感最容易产生于当工作处于能力范围边缘时。自己创造的事物就算很普通，和消费别人创造的质量上乘的事物相比，它仍然有一种与众不同的吸引力。</p>\n<h3 id=\"成员资格和慷慨\"><a href=\"#成员资格和慷慨\" class=\"headerlink\" title=\"成员资格和慷慨\"></a>成员资格和慷慨</h3><p>社会动机划分为宽泛的两大类：一类围绕着联系和成员，另一类则围绕着分享和慷慨。社会动机加强个人动机，索玛立方体实验中，完成解谜后的口头回报能让参与者更好地完成解谜；葛洛班之友慈善组织网站有一块“感谢您”的部分，感谢了对组织做出贡献的人，这为他们提供了一种激励。</p>\n<h3 id=\"业余动机和公共规模\"><a href=\"#业余动机和公共规模\" class=\"headerlink\" title=\"业余动机和公共规模\"></a>业余动机和公共规模</h3><p>在以前，有两种行为模式：行为源自内在动机的人们————业余爱好者，在相对私密的环境中活动，而源自外在动机的人们则在更公共的场合中活动。而如今我们拥有一些工具，能让团体中的人们彼此取得联系并分享思想和行动，于是我们就能看到一种奇怪的新组合：大型、公众的业余组织。比如Linux操作系统的发展。</p>\n<h3 id=\"放大渴望的反馈循环\"><a href=\"#放大渴望的反馈循环\" class=\"headerlink\" title=\"放大渴望的反馈循环\"></a>放大渴望的反馈循环</h3><p>以前，业余爱好活动的动机非常个人化：他们渴望自治和拥有胜任感。现在社会化媒体将发现成本降到低点，为创造和分享提供了一个平台，在这样一个反馈循环中，个人动机和社会动机可以相互放大。沉溺与对成员资格和共享的感觉中，会增加我们对更多连通性的渴望，而这又会增加表达。如此循环，终有一天，我们会达到一个新的参与业余爱好和消费的平衡。</p>\n<h3 id=\"内在动机和公共行为\"><a href=\"#内在动机和公共行为\" class=\"headerlink\" title=\"内在动机和公共行为\"></a>内在动机和公共行为</h3><p>代表某种权威行事一直以来都是最能激励人生的事情之一。如果能得到这种机会，人们通常都会做一些出乎他人意料的事。如果你给人们一个途径来依据自己对自治、胜任感、慷慨和共享的欲望行事，他们或许会接受，本书中每个成功的例子都和这样那样的内在动机有关。但是，如果你只是假装给人们提供一个内在动机的宣泄口，实际上却把他们塞进已设定好的框架中，那可能会遭到反叛。过去，组织成本太高，业余爱好者想在公共场地中做成点什么事太困难，因此他们的行为局限在私人范围内。如今社会化媒体为我们提供了能驾驭我们认知盈余的手段，使我们的活动可以扩展到公共领域。</p>\n<h2 id=\"第四章-“我们”-为-“我们”-创造机会\"><a href=\"#第四章-“我们”-为-“我们”-创造机会\" class=\"headerlink\" title=\"第四章 “我们” 为 “我们” 创造机会\"></a>第四章 “我们” 为 “我们” 创造机会</h2><p>方式和动机并不足以解释我们的认知盈余正在衍生出什么新用途。我们仍需要考虑机遇，即能将我们的能力实际运用到协同参与中的机会。对世界已有的信念和看法会阻碍人们看清现实。惊讶是旧信念被打破的感觉，本书描述的令人惊讶的新行为都有两个共同要素：一，人们有机会在鼓励内在动机的方式下行动；二，这些机会在科技的支持下变得可行，但机会本身是人造就的。</p>\n<h3 id=\"滑板与画室\"><a href=\"#滑板与画室\" class=\"headerlink\" title=\"滑板与画室\"></a>滑板与画室</h3><p>西风少年在空荡荡的游泳池里滑滑板，发展新风格和新技巧，办比赛，形成了现代滑板文化。所谓“领先用户创新”并不是有产品的设计者，而是由该产品最活跃的使用者来推动的。工具的性能并不完全决定其最终用途。西风少年的滑板环境形成了一个协作圈，大多数协作圈由一个互动频繁的核心组（西风少年）和一个根据参与深度不同而划分的边缘‘延伸组’（世界各地学习西风少年技术与规范的人）组成。核心组包括那些定期会面的成员，他们通过互动产生出新洞见。延伸组将核心组的观点加以传播。</p>\n<h3 id=\"最后通牒游戏\"><a href=\"#最后通牒游戏\" class=\"headerlink\" title=\"最后通牒游戏\"></a>最后通牒游戏</h3><p>人们无法摆脱自己作为一名社会成员的身份而做出行动，也无法避免在脑子里考虑这些行为会对社会成员带来的影响。人类道德标准的最大保障之一就是惩罚的意愿，即是否愿意去惩罚偏离公平准则、偏离道德规范的行为，即使这种惩罚会让自己付出一定的代价。“市场定价”天生就与“共同分享”这一组织人类事务的方式不相容，人类文化中以市场为导向的意识越淡薄，这种文化中的人就应该越慷慨和开放。但市场并非与集体分享格格不入，市场逻辑实际上增加了人们慷慨地与陌生人进行交易的意愿，部分是因为这就是市场运作的规律。然而，社会生产中的规范早已存在于市场文化中，并不代表着两种模式能轻易杂交。要从付钱让专家来做某事转化到让社区出于情感来做这件事，在技术上也许不难，但从社会层面上考虑，却会是一大难题。</p>\n<h3 id=\"联合协作：-群体创造价值\"><a href=\"#联合协作：-群体创造价值\" class=\"headerlink\" title=\"联合协作： 群体创造价值\"></a>联合协作： 群体创造价值</h3><p>数字网络让分享变得廉价，让全世界的人都成了潜在的参与者。拥有市场的社会为人们提供需要利用认知盈余来和陌生人互动的经验。在某些情况下，群体对资源的使用和管理的效果要优于市场和国家。依靠如下因素：参与者之间的相互可见的行为，对于共同目标的可靠承诺，以及成员们对不轨行为进行惩罚的能力。人在社会环境中的行为会有所节制，会表现得不那么自私。如今，我们可以期待在规模更大、分布更广的群体中，创造出这种共同尊重。</p>\n<h3 id=\"社会生产：-素未谋面的陌生人免费让你的生活更美好\"><a href=\"#社会生产：-素未谋面的陌生人免费让你的生活更美好\" class=\"headerlink\" title=\"社会生产： 素未谋面的陌生人免费让你的生活更美好\"></a>社会生产： 素未谋面的陌生人免费让你的生活更美好</h3><p>Apache的诞生与发展。将我们的自由时间和特殊才能汇聚在一起，共同创造，做有益之事的能力的增强，构成了这个年代巨大的新机遇之一。</p>\n<h3 id=\"Napster的成功，-新机遇与旧动机\"><a href=\"#Napster的成功，-新机遇与旧动机\" class=\"headerlink\" title=\"Napster的成功， 新机遇与旧动机\"></a>Napster的成功， 新机遇与旧动机</h3><p>新的行为方式往往是机遇的改变带来的，Napster的流行基于三个再平凡不过的原因：首先，数字化资源无需花费任何边际成本就可以无限复制；其次，如果分享足够容易，人们会很乐意分享，在同样的情况下，我们一般不愿表现出恶意；最后，设计出一个程序将前两个原因连接起来。通过正确的激励方式，将新的机遇与旧有动机结合起来，就可以从最基本的方面改变人与人之间的互动方式。</p>\n<h3 id=\"社会感染：-协作的螺旋\"><a href=\"#社会感染：-协作的螺旋\" class=\"headerlink\" title=\"社会感染： 协作的螺旋\"></a>社会感染： 协作的螺旋</h3><p>任何群体中都有偏离社会规范、消极行事的人，这些人在和其他社会成员享有相同机会和资源的情况下，依然会从事反社会甚至犯罪行为。正向偏差指的是那些面对同样的限制和挑战，比一般成员表现得更出色的人。将正向偏差集合起来制造社会感染，让社会变得更好。</p>\n<h2 id=\"第五章-这是一个创造慷慨文化的时代\"><a href=\"#第五章-这是一个创造慷慨文化的时代\" class=\"headerlink\" title=\"第五章 这是一个创造慷慨文化的时代\"></a>第五章 这是一个创造慷慨文化的时代</h2><p>日托中心对接孩子迟到的家长增设了罚金，迟到的的家长不降反增。罚金将日托由共享事物变成了赤裸裸的付费交易，允许家长将老师的时间看做商品，家长会认为罚金已经代表了由他们带来的不便的全部价值，罚金同时也消除了家长对因为伤害工作人员的善意而可能遇到的一些不确定后果的恐惧。之后当罚金取消，迟到家长的人数并没有降下来。市场交易不仅仅是在人类其它动机的基础上增添了东西，它的存在就足以改变人类。“罚金即价格”表明，在市场里与人做交易，会从根本上扭转人与人之间的关系。之前的索玛立方体研究证明将动机标价会减少人们做事的动机。这里的日托罚金研究证明将非市场交易行为标价以后，人们会减少把对方当做可以保持长期关系的人来对待的意愿。有些价值是市场创造不出来的，这些价值的创作只能靠一系列分享和相互协调性的假设，也就是靠文化。</p>\n<h3 id=\"文化是一种协调工具\"><a href=\"#文化是一种协调工具\" class=\"headerlink\" title=\"文化是一种协调工具\"></a>文化是一种协调工具</h3><p>炼金术士的信息不畅通，他们各自为阵，把炼金术当作秘籍。导致炼金术无法有持续性的进步，只能失败。“无形学院”的成员会将自己的方法、假设和结论逗公诸与众，成员们能够接触到群体的集体知识并建立起一个合作圈。使“无形学院”活下来并将炼金术提升为化学的，既不是工具也不是远见，而是文化。增加你所拥有的物品数量固然有益，但增加你的知识量所带来的则可能是革命性的改变。</p>\n<h3 id=\"共享经济学\"><a href=\"#共享经济学\" class=\"headerlink\" title=\"共享经济学\"></a>共享经济学</h3><p>知识是人类所拥有的最具兼容性的东西，但是要想利用它，就需要具备一些特殊条件： 社区规模的大小，共享知识的成本，被共享知识的明晰性，以及接受者们的文化规范。如今，通过全球化的、廉价的媒介，前三个条件已不再是问题。则最后一个条件文化（即一个社区关于事物如何运行、人与人之间关系如何协调的一套共享假设）显得尤为重要。一个实践社区的存在，与其说是为了维护社区中某些特殊的知识，不如说是为了维护将社区团结在一起的文化。</p>\n<h3 id=\"业余参与所带来的归属感\"><a href=\"#业余参与所带来的归属感\" class=\"headerlink\" title=\"业余参与所带来的归属感\"></a>业余参与所带来的归属感</h3><p>有些事，的确需要专业人士的专业技能来解决。但有时候，当我们与人合作或者为他人做某事的时候，虽然做砸了，但是效果却比请专业人员做并圆满完成任务更好。有时候专业工作的价值确实胜过业余分享或归属感的价值，但在另外一些情况下，大规模长时间的分享会让人感觉更好。当越来越多的人开始期待业余参与成为一种开放的选择时，期待就会改变文化。</p>\n<h3 id=\"同病相怜\"><a href=\"#同病相怜\" class=\"headerlink\" title=\"同病相怜\"></a>同病相怜</h3><p>“同病相怜”网站不再是医务人员单方持有信息，而是让患有相同慢性病的病友彼此分享信息，人人受益。这个故事阐明了我们在社会化媒体使用中面对的最重要问题之一，也就是，我们在多大程度上愿意利用认知盈余来创造真正的公民价值？</p>\n<h2 id=\"第六章-从公用价值到公民价值\"><a href=\"#第六章-从公用价值到公民价值\" class=\"headerlink\" title=\"第六章 从公用价值到公民价值\"></a>第六章 从公用价值到公民价值</h2><h3 id=\"个体的满足与群体的行为动机\"><a href=\"#个体的满足与群体的行为动机\" class=\"headerlink\" title=\"个体的满足与群体的行为动机\"></a>个体的满足与群体的行为动机</h3><p>抛弃旧有限制并不会引领我们进入一个没有限制的世界。无论是过去、现在还是将来的世界都有其限制，抛弃旧的限制仅仅是为了给制定新限制清理出空间。社会生产率的提高加剧了原有的个人与群体需求之间的冲突。一个追求共同目标的群体必须保证自己的高效率（否则它就是去了存在的意义），同时必须保证其成员具有满足感（否则其成员就是去了留在组织内的理由）。对于业余性的群体来说，个人满足感的问题更加重要，因为它对成员的内在动机会有更大的依赖性。大多数群体面临的主要威胁实际上来自于内部，这种威胁就是陷入仅仅满足于个人情绪需求但效率低下的行为模式中。</p>\n<h3 id=\"个人、-群体与自由\"><a href=\"#个人、-群体与自由\" class=\"headerlink\" title=\"个人、 群体与自由\"></a>个人、 群体与自由</h3><p>分享形式按规模划分的最主要四种形式： 个人分享，在原本没有任何联系的人们之间进行；公用分享，其参与性更强，在一个协作的群体之间进行；公共分享，协作群体积极尝试创造公共资源；公民分享，表现为一个群体积极尝试改变社会。个人分享是最简单的分享形式，参与者和受益者都以个人身份参与分享活动，从彼此的分享中获益。创造公用价值则更加复杂，未加协调的众多贡献集合起来可以创造个人的价值，而一个互相交流合作的群体则可以创造公用的价值。公共价值与公用价值一样需要广泛的交流，但要求参与者更为开放，并与新人和非参与者分享创造出来的价值。公民价值在开放性方面类似公共价值，但是对于致力于创造公民价值的团体来说，改良社会是他们显著的目标。完全的个人自由和完全的社会控制都不是最优的选择，管理个人自由和社会价值之间的矛盾成为我们的责任。</p>\n<h3 id=\"群体与治理\"><a href=\"#群体与治理\" class=\"headerlink\" title=\"群体与治理\"></a>群体与治理</h3><p>为了成功地创造和维持公共利益，一个群体必须抵御外界的威胁，同时抵御内在的威胁。对于一个共同目标的干扰源更可能来自该群体的组员。公共价值和社会价值的创造需要其核心参与团队的承诺和辛勤努力，还要求这些团体进行自我治理并致力于接受那些防止他们受到无关及娱乐元素干扰的限制措施，专注于处理复杂的任务。我们需要这样的群体创造出我们所需要的价值，而不仅是我们想要的价值。认识到应如何来创建和维护这样的群体，正是我们这个时代所面临的巨大挑战之一。</p>\n<h2 id=\"第七章-寻找鼠标，-世界是“闲”的\"><a href=\"#第七章-寻找鼠标，-世界是“闲”的\" class=\"headerlink\" title=\"第七章 寻找鼠标， 世界是“闲”的\"></a>第七章 寻找鼠标， 世界是“闲”的</h2><p>方式、动机和机会三者的融合，从积累的自由时间这个原材料中，生产出了认知盈余。真正的变化来自于我们认识到这种盈余所带来的前所未有的机会，或者更确切地说，它带来的前所未有的让我们为彼此创造机会的机会。公民价值不会因为社会的突然转型而凸显出来，也不会从个体行为中冒出来，公民价值反而是从群体的工作中衍生出来的，这些群体起初很小，但随着其规模和重要性的不断增加，协作圈、社区和实践的方式以及其他方面的群体方式都将得以不断优化。以群体的形式尝试新事物，是迄今为止也是将来对社会化媒体最为意义深远的利用。</p>\n<h3 id=\"革命的悖论\"><a href=\"#革命的悖论\" class=\"headerlink\" title=\"革命的悖论\"></a>革命的悖论</h3><p>新科技仅仅是给现存社会提供了解决正在解决的事情的快速而廉价的手段，对于一个社会来说，充足是比稀缺更难解决的问题。新工具所提供的机会越多，任何人可以从之前社会形态推断未来的可能性也就越小。微小的变化能蔓延，巨大的变化会滞后，我们对预测我们未来的行为实在是太不在行了。因此，要从一个工具中创造出最大的价值，靠的并不是总体规划或者跨越式发展，而是连续不断的尝试与错误。</p>\n<h3 id=\"改进的可能\"><a href=\"#改进的可能\" class=\"headerlink\" title=\"改进的可能\"></a>改进的可能</h3><p>创建新型社会化媒体的诀窍在于，使用那些教训来掂量对你有利的机会，而不是将它们作为一套保证成功的宝典。创造新机会，应对早期的成长，以及根据用户不断带来的意外做出调整。</p>\n<h4 id=\"起步\"><a href=\"#起步\" class=\"headerlink\" title=\"起步\"></a>起步</h4><p>从小做起：社会化媒体中一条名副其实的自然法则是，为了拥有一个大型而优秀的系统，最好从一个小型而优秀的系统做起，并且努力使它变大变强，这样做远远好过从一个大型却平淡无奇的系统做起并努力改进。<br>问问“为什么”：每个人在做事情时都存在不同的动机，进而创造出不同的参与逻辑。<br>行为追随机会：行为即是被机会过滤之后的动机。你想要用户在多大程度上按照某种特定方式行动并不重要，重要的是他们对于你提供的机会会做出何种反应。如果你想得到不同的行为，你就必须提供不同的机会。<br>默认的胜利：对默认值的小心使用可以塑造用户的行为，因为用户们互相交流了一些期望。</p>\n<h4 id=\"成长\"><a href=\"#成长\" class=\"headerlink\" title=\"成长\"></a>成长</h4><p>中间规模的团体，作为单个团体来运行通常太大，但是被当做社会化自给自足的团体来说又太小，中型团体的一员常常既感受不到亲密感所带来的快乐，也得不到都市规模和多样性带来的好处。这里便是形成文化的地方，一种文化一旦建立起来，便很难再改变。<br>系统越大，核心与边缘团队之间的差异就会越彰显。使得“平均用户”不可能出现，也没有用处。<br>亲密度从不扩大，在一个小团体里每个人都可以紧紧相连，一旦团体变大，不是一些人变成了观众，就是人们各自形成了小型的、相互重叠但依然亲密的团体。你可以拥有大量的用户，你可以拥有活跃的用户群，你也可以拥有志同道合的用户群。但三者中，你只能选择其二。<br>创造一种支持型文化，可见的执行规则的意愿实际上减少了需要花在执行规则上的精力。</p>\n<h4 id=\"不断调整，-不断学习\"><a href=\"#不断调整，-不断学习\" class=\"headerlink\" title=\"不断调整， 不断学习\"></a>不断调整， 不断学习</h4><p>学得越快，适应越快。<br>成功比失败带来更多的问题，要想解决难题，必须先遇到难题。提前对成功的后果进行防范会大大减少回报，用于尝新，敢于迎接相继出现的困难，比在没有遇到任何问题的情况下闭门造车更有效。<br>靠人们的内在动机加上自由时间来做成一件事是如此的缓慢和充满不确定性。文化不是靠命令产生出来的。任务的关键并不是要完成某件事，而是要去创造一种让人们愿意去做事的环境。<br>没有任何一套规则或指南可以描绘出所有可能的情况，要勇于尝试任何事，尝试每件事。</p>\n<h3 id=\"应对一场革命的三种方式\"><a href=\"#应对一场革命的三种方式\" class=\"headerlink\" title=\"应对一场革命的三种方式\"></a>应对一场革命的三种方式</h3><p>一项新的沟通技术的出现和就有制约的终止会改变我们的结缔组织，所以重大的新机遇总是会造成对社会的重构。什么是一项新技术融入社会的理想方式？有三种：“我们尽可能承受的混乱无序”，即用新技术去尝试任何事；“传统主义者的认可”，即让新技术掌握在当前行事方式负责的人手上；“协议转让”，即改革派与传统者协商。后两者都不可行。</p>\n<h3 id=\"寻找鼠标\"><a href=\"#寻找鼠标\" class=\"headerlink\" title=\"寻找鼠标\"></a>寻找鼠标</h3><p>我们已经从一个专业人员掌控的公共广播和人与人之间的私人对话的世界转变成一个公共和私人媒介糅合在一起，专业和业余生产界限模糊，志愿公共参与与从无到不可或缺的世界。以你为对象的媒体如果没有将你包含进去，那么就不值得在它面前待太久。我们该给彼此参与的机会，对彼此的尝试做出奖励，哪怕开凿出一点点认知盈余，加以利用，我们会让事情变得更好。</p>\n","categories":[],"tags":["读书笔记"]},{"title":"[学习笔记]深入理解CSS定位机制之浮动与绝对定位","url":"http://charles-hang.github.io/2016/09/28/sn-css-fltAbt/","content":"<h1 id=\"前记\"><a href=\"#前记\" class=\"headerlink\" title=\"前记\"></a>前记</h1><p>本篇深入理解浮动与绝对定位，会加入较多的布局技巧与应用。本篇结论与方法绝大多数来自于<strong>张鑫旭</strong>大神，先在此拜谢！</p>\n<h1 id=\"浮动-Float\"><a href=\"#浮动-Float\" class=\"headerlink\" title=\"浮动(Float)\"></a>浮动(Float)</h1><p>浮动的<strong>设计初衷只是让文字环绕图片</strong>而已，但是没有一件东西的使用规则是完全按照设计师来的，决定权在使用者，使用者们总是会探寻一切其它的可能。所以，我们目前利用浮动来布局本不是浮动该干的事，那么出现的种种问题也就理所当然了。</p>\n<h2 id=\"浮动特性\"><a href=\"#浮动特性\" class=\"headerlink\" title=\"浮动特性\"></a>浮动特性</h2><h3 id=\"浮动的“包裹性”\"><a href=\"#浮动的“包裹性”\" class=\"headerlink\" title=\"浮动的“包裹性”\"></a>浮动的“包裹性”</h3><p>浮动属性在某种意义上来说与<code>display: inline-block</code>属性的作用是一样的，只是浮动具有方向性而已。所以也可以这样说：浮动就是个带有方位的<code>display: inline-block</code>属性.</p>\n<h3 id=\"浮动的“破坏性”\"><a href=\"#浮动的“破坏性”\" class=\"headerlink\" title=\"浮动的“破坏性”\"></a>浮动的“破坏性”</h3><p>浮动脱离了文档流，使父元素高度坍塌,也造成了浮动元素间紧密排列的特性。</p>\n<h3 id=\"浮动的定位原则\"><a href=\"#浮动的定位原则\" class=\"headerlink\" title=\"浮动的定位原则\"></a>浮动的定位原则</h3><p>浮动的定位原则有balabala好多，但可以总结为：<strong>在其左</strong>、<strong>上</strong>、<strong>右外边界不溢出包含块边界的情况下</strong>，<strong>尽量的靠上</strong>、<strong>靠左</strong>（<code>float:left</code>）<strong>或靠右</strong>（<code>float:right</code>）<strong>放置</strong>，<strong>但是不能高于它前面生成的块框</strong>、<strong>浮动框和行框的顶边</strong>，<strong>并且不能与其他浮动元素重叠</strong>。</p>\n<h2 id=\"清除浮动\"><a href=\"#清除浮动\" class=\"headerlink\" title=\"清除浮动\"></a>清除浮动</h2><p>上篇提到了可以通过创建BFC清除浮动，还可以在父级元素上加伪元素：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.clearfix</span><span class=\"selector-pseudo\">:after</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">' '</span>;</div><div class=\"line\">    <span class=\"attribute\">display</span>: block;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">    <span class=\"attribute\">clear</span>: both;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>上面是大家常用的，其实还有个简短的，应推广：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.clearfix</span><span class=\"selector-pseudo\">:after</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">' '</span>;</div><div class=\"line\">    <span class=\"attribute\">display</span>: table;</div><div class=\"line\">    <span class=\"attribute\">clear</span>: both;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"clear特性\"><a href=\"#clear特性\" class=\"headerlink\" title=\"clear特性\"></a>clear特性</h3><p>设置了clear特性值的元素，其 <code>top border edge</code> 要放在相关的浮动元素的 <code>bottom margin edge</code> 之下。注意这两种元素接触边界的区别。一个是 border，一个是 margin。这与外边距折叠无关，因为浮动元素不与其他元素发生外边距折叠。<br>代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width:300px; height:100px; background-color:green; float:left; border:5px solid red; margin-bottom:10px;\"</span>&gt;</span></div><div class=\"line\">    float</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"clear:left; width:350px; height:50px; background-color:green; border:5px solid yellow; margin-top:50px;\"</span>&gt;</span></div><div class=\"line\">    clearance</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/1.png\" alt=\"clear prop\"></p>\n<h2 id=\"浮动与流体布局\"><a href=\"#浮动与流体布局\" class=\"headerlink\" title=\"浮动与流体布局\"></a>浮动与流体布局</h2><h3 id=\"文字环绕衍生-单侧固定\"><a href=\"#文字环绕衍生-单侧固定\" class=\"headerlink\" title=\"文字环绕衍生-单侧固定\"></a>文字环绕衍生-单侧固定</h3><p>以下是左侧固定，右侧自适应的布局示例：<br>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.box</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#D2CCCC</span>;</div><div class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.word</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">    <span class=\"comment\">/*或者padding-left: 100px;*/</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"xing.jpg\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"xing\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"word\"</span>&gt;</span></div><div class=\"line\">        文字环绕衍生-单侧固定文字环绕衍生-单侧固定文字环绕衍生-单侧固定文字环绕衍生-单侧固定文字环绕衍生-单侧固定</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/2.jpg\" alt=\"left fixed\"><br>上面的<strong>关键</strong>是，左侧：width+float；右侧：padding-left/margin-left。局限在于固定侧的宽度必须已知。</p>\n<h3 id=\"DOM与显示位置相匹配的单侧固定\"><a href=\"#DOM与显示位置相匹配的单侧固定\" class=\"headerlink\" title=\"DOM与显示位置相匹配的单侧固定\"></a>DOM与显示位置相匹配的单侧固定</h3><p><img src=\"http://charles-hang.github.io/images/16_9_28/3.jpg\" alt=\"DOM match\"><br>要实现上面右侧固定，左侧自适应的布局效果且DOM流中图片在文本后面，如按前面的方法，则需将图片在DOM流中的位置提前，再改为右侧固定即可，但这样就修改了DOM顺序，那怎么做呢？<br>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.box</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#D2CCCC</span>;</div><div class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">80px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.word-wrap</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.word</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">margin-right</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">    <span class=\"comment\">/*或者padding-right: 100px;*/</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"word-wrap\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"word\"</span>&gt;</span></div><div class=\"line\">            DOM与显示位置相匹配的单侧固定DOM与显示位置相匹配的单侧固定DOM与显示位置相匹配的单侧固定DOM与显示位置相匹配的单侧固定DOM与显示位置相匹配的单侧固定</div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"xing.jpg\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"xing\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p><strong>关键</strong>是，左侧自适应部分加一包裹容器并设置：width:100%+float:left，左侧自适应部分：padding-right/margin-right，右侧：width+float:left+margin-left负值。局限仍是固定侧的宽度必须已知。这里需要大家好好琢磨琢磨，多动手试试。</p>\n<h3 id=\"智能自适应单侧固定\"><a href=\"#智能自适应单侧固定\" class=\"headerlink\" title=\"智能自适应单侧固定\"></a>智能自适应单侧固定</h3><p>当固定侧宽度不定时，怎么达到自适应的效果呢？还记得上篇BFC消除文字环绕吗？对，这里就引申出了<strong>浮动+BFC</strong>的强大的自适应固定搭配。<br>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.box</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#D2CCCC</span>;</div><div class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">80px</span>;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">    <span class=\"attribute\">margin-right</span>: <span class=\"number\">10px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.word</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"xing.jpg\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"xing\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"word\"</span>&gt;</span></div><div class=\"line\">        智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定智能自适应单侧固定</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>左侧<code>float:left</code>,右侧<code>overflow:hidden</code>。当调节img宽度时，右侧能自适应左侧的宽度。<br>不过，有些场景下我们不能使用<code>overflow:hidden</code>,<strong>这时</strong>，<strong>另一个能创建BFC的属性登场了</strong>：<br>将上面<code>overflow:hidden;</code>处代码更换为：<code>display:table-cell;width:2000px;</code>,单元格有个非常神奇的特性，就是你宽度值设置地再大，实际宽度也不会超过表格容器的宽度。所以说，只要我们将宽度设置得足够大，那其实就跟block水平元素自动适应容器空间效果一模一样了。兼容性：IE8+，IE6/7下也有办法，但对IE深恶痛绝的我拒绝解决这个问题。</p>\n<h1 id=\"绝对定位-Absolute-positioning\"><a href=\"#绝对定位-Absolute-positioning\" class=\"headerlink\" title=\"绝对定位(Absolute positioning)\"></a>绝对定位(Absolute positioning)</h1><p>绝对定位同样也有浮动的‘包裹性’与‘破坏性’，所以布局时，我们也经常让两者相互替代。</p>\n<h2 id=\"无依赖的绝对定位\"><a href=\"#无依赖的绝对定位\" class=\"headerlink\" title=\"无依赖的绝对定位\"></a>无依赖的绝对定位</h2><p>无依赖的绝对定位的意思是<strong>不受包含块(如设了relative的父级)的限制</strong>，<strong>不使用top/right/bottom/left来帮助精确定位的绝对定位</strong>。使用的是margin-top/margin-left(margin-right和margin-bottom不起作用)。绝对定位后，元素会脱离文档流，且有<strong>位置跟随特性</strong>，位置跟随就是绝对定位之前它在什么位置，绝对定位之后它还在什么位置。这样，利用跟随性和margin来实现的定位就是无依赖的绝对定位，特性非常强大！</p>\n<h2 id=\"无依赖的绝对定位应用\"><a href=\"#无依赖的绝对定位应用\" class=\"headerlink\" title=\"无依赖的绝对定位应用\"></a>无依赖的绝对定位应用</h2><h3 id=\"图标定位\"><a href=\"#图标定位\" class=\"headerlink\" title=\"图标定位\"></a>图标定位</h3><p>例一代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">15px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">15px</span>;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: -<span class=\"number\">12px</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">2px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>课程<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"xin.png\"</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/4.jpg\" alt=\"s icon1\"><br>当标签变为‘新课程’后<br><img src=\"http://charles-hang.github.io/images/16_9_28/5.jpg\" alt=\"s icon2\"><br>如果使用的是relative帮助的话，当标签名变长后，可能会出现这样的重叠现象：<br><img src=\"http://charles-hang.github.io/images/16_9_28/6.jpg\" alt=\"s icon3\"><br>例二代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">div</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">480px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">i</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">22px</span>;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">38px</span>;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">url</span>(-58-43.png) -<span class=\"number\">58px</span> -<span class=\"number\">43px</span> no-repeat;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.vip</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">21px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"wwdc.jpg\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"wwdc\"</span>&gt;</span><span class=\"comment\">&lt;!--</span></div><div class=\"line\"> --&gt;<span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">class</span>=<span class=\"string\">\"vip\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"vip.png\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"vip\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/7.jpg\" alt=\"s icon4\"><br>免费图标仅用了<code>position:absolute;</code>vip图标仅用了<code>position:absolute;margin-left:-21px</code>。无依赖的绝对定位对DOM流中的位置有要求，免费图标absolute前在大图前面，绝对定位后由于跟随性自然就到位了。vip图标呢，绝对定位之后，宽高相当于零了，还有大家注意到<code>&lt;!-- --&gt;</code>了吗，这是消除vip图标与前面元素间隙的方法，这样绝对定位后，宽高相当于零的vip图标由于跟随性就自然跟在大图后，像下面这样，然后margin负拉回来即可。<br><img src=\"http://charles-hang.github.io/images/16_9_28/8.jpg\" alt=\"s icon5\"><br>这样定位的优点显而易见，如果按常规实现，就要在父容器加relative，如果日后维护修改需要去掉父级的relative，那整个定位就崩了。无依赖的绝对定位与父级没有关系，这样更健壮，更易于日后维护修改。<br>需要注意的是，无依赖的绝对定位对跟随性的理解要求较高，需在工作中积累经验达到能熟练的使用。</p>\n<h3 id=\"居中及边缘对齐定位\"><a href=\"#居中及边缘对齐定位\" class=\"headerlink\" title=\"居中及边缘对齐定位\"></a>居中及边缘对齐定位</h3><p>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">body</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#EDEFF0</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.container</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">950px</span>;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> auto;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">2000px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#fff</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box1</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">800px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#CE96F6</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box2</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: center;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box2</span> <span class=\"selector-tag\">img</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">50px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">50px</span>;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">25px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box3</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: right;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box3-fixed</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">display</span>: inline;</div><div class=\"line\">    <span class=\"attribute\">position</span>: fixed;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: <span class=\"number\">20px</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.box3-fixed</span> <span class=\"selector-tag\">a</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">display</span>: block;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">48px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">48px</span>;</div><div class=\"line\">    <span class=\"attribute\">margin-top</span>: <span class=\"number\">10px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">url</span>(1.png) -<span class=\"number\">48px</span> <span class=\"number\">0</span> no-repeat;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box1\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box2\"</span>&gt;</span></div><div class=\"line\">        &amp;nbsp;<span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"xing.jpg\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"xing\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box3\"</span>&gt;</span></div><div class=\"line\">        &amp;nbsp;<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"box3-fixed\"</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/9.jpg\" alt=\"center edge\"><br>这里图片居中的原理就是先将空格居中对齐，再对图片absolute+margin负。这个方式并不是最佳实践，只是开拓一下定位思路用。<br>接下来的边缘固定可有说法了，先将空格右对齐，再利用<code>display:inline</code>属性跟随其后，绝对定位后再用margin微调即可。这里可就比常规实现好多了，大多数网站都是绝对定位后，left:50%+margin-left大容器宽度一半的方式来实现，这样需要计算，且如果大容器宽度会变化，那么还要利用js来处理。从这里，无依赖绝对定位的优势就充分体现了。<br>其实无依赖绝对定位应用还有很多，像什么图标后跟文字，两者经常对不齐，位置需微调时可用。还有因为不依赖relative，就可以突破overflow的限制实现一些小功能等等。无依赖的绝对定位在便捷性，健壮性上都非常优秀，为页面布局与重构提供了许多新思路。</p>\n<h2 id=\"依赖的绝对定位\"><a href=\"#依赖的绝对定位\" class=\"headerlink\" title=\"依赖的绝对定位\"></a>依赖的绝对定位</h2><p>这里也就是行为表现上使用top/right/bottom/left的绝对定位。<br>常规的绝对定位这里就不说了，还记得上篇讲relative时，top和bottom,left和right同时出现时的情况吗？结果必定是一方得胜。绝对定位就不一样了，top和bottom，left和right同时出现时，结果不是一方得胜，而是拉伸的实现(兼容性IE7+)。也就是说，很多情况下，absolute的拉伸与width/height是可以相互替代的！比如：<br><code>position: absolute; left: 0; top: 0; width: 50%;</code><br>等同于<br><code>position: absolute; left: 0; top: 0; right: 50%;</code><br>在某种程度上，拉伸更强大。比如，要实现一个距离右侧200像素的全屏自适应的容器层。<br>拉伸实现：<code>position: absolute; left: 0; right: 200px;</code><br>但是，要用width的话，只能使用CSS3 的calc计算：<code>position: absolute; left: 0; width: calc(100% - 200px)</code><br>两者具有相互支持性：</p>\n<ol>\n<li><strong>容器无需固定width/height值</strong>，<strong>内部元素就可拉伸</strong>。这里自己体会。</li>\n<li><strong>容器拉伸</strong>，<strong>内部元素支持百分比width/height值</strong>。<br>通常情况下，元素百分比高要想起作用，需要父级容器的height不是auto。但在绝对定位拉伸下，即使父级容器的height值是auto，只要容器绝对定位拉伸形成，就支持百分比高度。在移动端的应用较为常见。<br>代码：<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.page</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.list</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">33.3%</span>;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">30%</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#CDADE7</span>;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">16px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"page\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/10.jpg\" alt=\"stretch\"><br>最后，拉伸与width/height同时存在时有相互合作性（引申出另一种居中方法）：<br>当两者同时存在时，实际宽高以width/height为准。当出现<code>margin: auto;</code>时，就实现了绝对居中效果（兼容性IE8+）。<br>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.page</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#333</span>;</div><div class=\"line\">    <span class=\"attribute\">position</span>: relative;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.con</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">50%</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">50%</span>;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: auto;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#B991F4</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"page\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"con\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/11.jpg\" alt=\"abt center\"></p>\n<h2 id=\"absolute网页整体布局（适合于移动web的布局）\"><a href=\"#absolute网页整体布局（适合于移动web的布局）\" class=\"headerlink\" title=\"absolute网页整体布局（适合于移动web的布局）\"></a>absolute网页整体布局（适合于移动web的布局）</h2><p>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">html</span>,</div><div class=\"line\"><span class=\"selector-tag\">body</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">100%</span>;   </div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.page</span>,</div><div class=\"line\"><span class=\"selector-class\">.overplay</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">header</span>,</div><div class=\"line\"><span class=\"selector-tag\">footer</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">right</span>: <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">header</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">60px</span>;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#FA5B5B</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">footer</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">55px</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#F174B8</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">aside</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">260px</span>;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">60px</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#FD996E</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.content</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">position</span>: absolute;</div><div class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">60px</span>;</div><div class=\"line\">    <span class=\"attribute\">bottom</span>: <span class=\"number\">55px</span>;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">260px</span>;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: auto;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.overplay</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(0,0,0,.4);</div><div class=\"line\">    <span class=\"attribute\">z-index</span>: <span class=\"number\">3</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"page\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aside</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">aside</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"content\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">footer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">footer</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"overplay\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_28/12.jpg\" alt=\"layout\"><br>布局思路：</p>\n<hr>\n<ol>\n<li>body降级 子元素升级。page拉伸，需要设置html body高度百分百。</li>\n<li>各模块-头尾、侧边框用绝对定位各居其位。</li>\n<li>内容区域想象成body，里面小伙伴愉快玩耍。</li>\n<li>为实现一些加载提示效果，布局全屏覆盖与page平级。这样两者相互不影响。</li>\n</ol>\n<hr>\n<p>这样的布局头尾侧边框等实现了与fixed一样的效果，还避免了移动端<code>position:fixed</code>实现的诸多问题，值得一试。</p>\n<h1 id=\"display、position和float的相互关系\"><a href=\"#display、position和float的相互关系\" class=\"headerlink\" title=\"display、position和float的相互关系\"></a>display、position和float的相互关系</h1><p>可以把这看做是一个类似<strong>优先级的机制</strong>，<code>position:absolute</code> 和 <code>position:fixed</code>优先级最高，有它存在的时候，浮动不起作用，<code>display</code>的值会重置（规则见下表）； 其次，元素的<code>float</code>特性的值不是<code>none</code> 的时候或者它是根元素的时候，<code>display</code>的值会重置； 最后，非根元素，并且非浮动元素，并且非绝对定位的元素，<code>display</code> 特性值同设置值。这些规则简单但平时却容易忽视。<br>转换对应表：<br><img src=\"http://charles-hang.github.io/images/16_9_28/13.jpg\" alt=\"display trans\"></p>\n<p>深入理解CSS定位机制篇完结！</p>\n","categories":["css"],"tags":["学习笔记","css定位"]},{"title":"开博第一篇","url":"http://charles-hang.github.io/2016/09/27/first-blog/","content":"<p>学习前端四个多月了，前端的日新月异，爆炸的知识量也是有所体会。现在回头看看，之前的很多知识点也有些许模糊。这几个月来，自己对读书的兴趣也是大增，可读书的方法也是门学问，怎么才能让书真正读进自己肚子里很重要。同时自己也时常有些新的想法与感悟，感觉就这么让它们溜走太可惜。自己越发的想把这些东西都好好地记下来。个人的知识管理的确十分重要，很大程度影响着自己的成长速度与生存空间。后知后觉，感觉是时候开个博客，微博啥的把这些财富好好的管理起来。在自己精心总结记录学习笔记、读书笔记、心得感想的过程中本就是一种进步，再时常的回顾复习，自己的知识系统便会不断巩固，结成网；让自己的思想水平逐步提高。希望这篇博客能打开自己一个崭新的开始！<br>最后送自己一句话：奋斗就是让自己过得不舒服，跳出了舒适区，才能野蛮生长。</p>\n","categories":[],"tags":["感想"]},{"title":"[学习笔记]深入理解CSS定位机制之常规流","url":"http://charles-hang.github.io/2016/09/10/sn-css-normalFlow/","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><p>CSS有三种基本的定位机制：<strong>常规流</strong>（Normal flow）、<strong>浮动</strong>（Floats）、<strong>绝对定位</strong>（Absolute positioning）。分两篇讲述：常规流篇，浮动和绝对定位篇。</p>\n<h1 id=\"常规流\"><a href=\"#常规流\" class=\"headerlink\" title=\"常规流\"></a>常规流</h1><p>常规流看似就是块级元素、行内元素依据他们的显示属性按照在文档中的先后次序依次显示，好像没啥说的。其实不然，常规流作为默认的定位模式，其他的定位模式都以其为基础。在 CSS2.1中，常规流包括块框( block boxes )的块格式化( block formatting )， 行内框( inline boxes )的行内格式化( inline formatting )，块框或行内框的相对定位，以及插入框的定位。</p>\n<h2 id=\"块级格式化上下文（BFC）\"><a href=\"#块级格式化上下文（BFC）\" class=\"headerlink\" title=\"块级格式化上下文（BFC）\"></a>块级格式化上下文（BFC）</h2><h3 id=\"触发方式\"><a href=\"#触发方式\" class=\"headerlink\" title=\"触发方式\"></a>触发方式</h3><p>一个新的BFC可以通过给一个容器添加如下属性来创建：<br>浮动（float值不为none）<br>绝对定位（position值不为relative和static）<br>display值为table-cell，table-caption，inline-block，flex，inline-flex中任何一个<br>overflow值不为visible</p>\n<h3 id=\"表现特性及应用\"><a href=\"#表现特性及应用\" class=\"headerlink\" title=\"表现特性及应用\"></a>表现特性及应用</h3><p>BFC说到底就是一个<strong>独立的渲染区域</strong>，<strong>BFC里面的元素不论怎么翻江倒海</strong>，<strong>使劲折腾都不会影响到外面的元素</strong>。在BFC中，每一个元素左外边与包含块的左边相接触（对于从右到左的格式化，右外边接触右边）， 即使存在浮动也是如此。<br><img src=\"http://charles-hang.github.io/images/16_9_10/1.jpg\" alt=\"BFC BOX\"><br>BFC与普通的块盒子类似，不同之处在于：<strong>可以阻止外边距折叠</strong>，<strong>可以包含浮动元素</strong>，<strong>可以防止元素被浮动元素覆盖</strong>。</p>\n<h4 id=\"用BFC阻止外边距折叠\"><a href=\"#用BFC阻止外边距折叠\" class=\"headerlink\" title=\"用BFC阻止外边距折叠\"></a>用BFC阻止外边距折叠</h4><p>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">p</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#827171</span>;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: center;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">50px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>margin折叠了<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>是的，折叠了<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/2.png\" alt=\"margin fold\"><br>修改代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">div</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">p</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#827171</span>;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: center;</div><div class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">50px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>成功阻止margin折叠了<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>好尴尬啊<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/3.png\" alt=\"margin unfold\"><br>使用overflow：hidden创建了一个BFC。</p>\n<h4 id=\"使用BFC来包含浮动元素\"><a href=\"#使用BFC来包含浮动元素\" class=\"headerlink\" title=\"使用BFC来包含浮动元素\"></a>使用BFC来包含浮动元素</h4><p>我们都知道float会使父元素高度坍塌，通常我们用清除浮动来解决这个问题，最常用的就是使用clearfix伪类元素，但我们同样可以通过定义一个BFC来达到这个目的，这就是我们平常为父元素添加<code>overflow: hidden;</code>属性的原理，这里大家都懂，就不演示了。具体的float特性及清除浮动到下篇详细讲解。</p>\n<h4 id=\"使用BFC防止文字环绕\"><a href=\"#使用BFC防止文字环绕\" class=\"headerlink\" title=\"使用BFC防止文字环绕\"></a>使用BFC防止文字环绕</h4><p>这里利用的就是BFC的区域不会与float box重叠。<br>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">body</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.float</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">float</span>: left;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">150px</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#FB6E7C</span>;</div><div class=\"line\">    <span class=\"attribute\">opacity</span>: <span class=\"number\">0.4</span>;</div><div class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">10px</span>;</div><div class=\"line\">    <span class=\"attribute\">margin-top</span>: -<span class=\"number\">10px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">p</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</div><div class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#827171</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">'float'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字 环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果文字环绕效果<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/4.png\" alt=\"text surround\"><br>从这个效果图中我们也可以理解为什么文字会环绕。<br>修改代码：为p元素增加样式<code>overflow: hidden;</code><br>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/5.png\" alt=\"eliminate surround\"><br>p元素创建了个BFC。这样就不会与左侧的float元素重叠，由此还产生了一些布局应用，下篇再说。</p>\n<h2 id=\"行内格式化上下文（IFC）\"><a href=\"#行内格式化上下文（IFC）\" class=\"headerlink\" title=\"行内格式化上下文（IFC）\"></a>行内格式化上下文（IFC）</h2><p>IFC控制着内联元素的布局，这里就不得不介绍下行内框盒子模型了，所有的内联元素的样式表现都与行内框盒子模型有关。行内框盒子模型里包含着四种盒子。以下面p标签内的一行文字说明。<br><img src=\"http://charles-hang.github.io/images/16_9_10/6.png\" alt=\"line box e.g.\"></p>\n<ol>\n<li><strong>内容区域</strong>（content area），是一种围绕文字看不见的盒子，它的大小与font-size大小相关。可近似将鼠标选中文字的区域看做内容区域。<br><img src=\"http://charles-hang.github.io/images/16_9_10/7.jpg\" alt=\"content area\"></li>\n<li><strong>行内框</strong>（inline boxes），行内框不会让内容成块显示，而是排成行。如果文字外含inline水平的标签（span，a，em等），则属于行内框，如果是光秃秃的文字，则属于匿名行内框。如下图中，蓝框表示的是一个行内框，两个红框表示的是两个匿名行内框。<br><img src=\"http://charles-hang.github.io/images/16_9_10/8.jpg\" alt=\"inline boxes\"></li>\n<li><strong>行框</strong>（line boxes），每一行就是一个行框，每个行框又是由一个一个行内框组成的。如下图。<br><img src=\"http://charles-hang.github.io/images/16_9_10/9.jpg\" alt=\"line boxes\"></li>\n<li><strong>包含盒子</strong>（containing box），p标签所在的包含盒子，由一行一行的行框组成。注意与p元素的块不是一回事。<br><img src=\"http://charles-hang.github.io/images/16_9_10/10.jpg\" alt=\"containing box\"><br>行内框可能被分割<br>代码：<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">\"background-color:silver; width:100px;\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">style</span>=<span class=\"string\">\"border:1px solid blue; font-size:50px;\"</span>&gt;</span>text in span<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">em</span> <span class=\"attr\">style</span>=<span class=\"string\">\"border:1px solid yellow; font-size:30px; vertical-align:top;\"</span>&gt;</span>great1<span class=\"tag\">&lt;/<span class=\"name\">em</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/11.png\" alt=\"inline break\"><br>如果一个行内框超出包含它的行框的宽度，它会被分割成几个框，并且这些框会被分布到几个行框内。如果一个行内框被分割，<strong>margin</strong>、<strong>padding 和 border 在所有分割处没有视觉效果</strong>。<br>IFC布局规则，行内框会从包含块的顶部开始，一个接一个水平摆放。摆放这些框的时候，它们水平的margin、padding、border有效，垂直无效。不能指定宽高。行框的宽度是由包含块和存在的浮动来决定。行框的高度由行高计算规则决定。<br><img src=\"http://charles-hang.github.io/images/16_9_10/12.png\" alt=\"line box width\"><br>这里我想有必要拓展一下，对line-height进行深入理解，以更好地体会IFC。</p>\n<h2 id=\"line-height深入\"><a href=\"#line-height深入\" class=\"headerlink\" title=\"line-height深入\"></a>line-height深入</h2><h3 id=\"line-height的高度机理\"><a href=\"#line-height的高度机理\" class=\"headerlink\" title=\"line-height的高度机理\"></a>line-height的高度机理</h3><p><strong>行高</strong>，<strong>两行文字基线之间的距离</strong>。接着上一小节，<strong>p元素的高度不是由里面的文字撑开的</strong>，<strong>是由line-height决定的</strong>，如下证明：<br><code>font-size: 36px;</code> <code>line-height: 0;</code>下的表现：<br><img src=\"http://charles-hang.github.io/images/16_9_10/13.png\" alt=\"line-height test1\"><br><code>font-size: 0;</code> <code>line-height: 36px;</code>下的表现：<br><img src=\"http://charles-hang.github.io/images/16_9_10/14.png\" alt=\"line-height test2\"><br>有这样一个公式：<strong>内容区域高度</strong> + <strong>行间距</strong> = <strong>行高</strong>。内容区域高度只与字号以及字体有关，与行高无关。宋体下，公式可写为：font-size + 行间距 = 行高。上面说了行高决定了高度，但是呢高度的表现是内容区域高度加上下两个半行间距决定的，这里好好结合行高的定义琢磨下。所以做个小总结，<strong>行高决定行内框高度</strong>，<strong>行间距自动调整大小</strong>（甚至负值，上面测试例子里，line-height= 0时，行间距为-36px）<strong>以保证高度正好等于行高</strong>。<strong>高度在页面上的表现是由内容区域高度和行间距决定的</strong>。</p>\n<h3 id=\"line-height的一些实际应用\"><a href=\"#line-height的一些实际应用\" class=\"headerlink\" title=\"line-height的一些实际应用\"></a>line-height的一些实际应用</h3><h4 id=\"line-height的三个属性值差别\"><a href=\"#line-height的三个属性值差别\" class=\"headerlink\" title=\"line-height的三个属性值差别\"></a>line-height的三个属性值差别</h4><p>line-height分别为1.5、150%、1.5em有何区别？<br>line-height: 1.5 下面的所有可继承元素根据font-size重计算行高。<br>line-height: 150%/1.5em 当前元素根据font-size计算行高，继承给下面的元素。</p>\n<h4 id=\"line-height与图片的表现\"><a href=\"#line-height与图片的表现\" class=\"headerlink\" title=\"line-height与图片的表现\"></a>line-height与图片的表现</h4><p>我们都应该遇到过下面的情况，图片底部有间隙。<br><img src=\"http://charles-hang.github.io/images/16_9_10/15.png\" alt=\"img gap1\"><br>其实这是图片后的<strong>隐匿文本</strong>起的作用，给图片后加一个字便明了了<br><img src=\"http://charles-hang.github.io/images/16_9_10/16.png\" alt=\"img gap2\"><br>这里它们默认是以基线对齐的，所以下边多出了一块。知道了原因，那么消除这个底部间隙的方法就知道了：</p>\n<ol>\n<li><p>图片块状化（无基线对齐了）</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;<span class=\"attribute\">display</span>: block;&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>图片底线对齐</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">img</span> &#123;<span class=\"attribute\">vertical-align</span>: bottom;&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>行高足够小（导致基线上移）</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.box</span> &#123;<span class=\"attribute\">line-height</span>: <span class=\"number\">0</span>;&#125;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"多行文本水平垂直居中\"><a href=\"#多行文本水平垂直居中\" class=\"headerlink\" title=\"多行文本水平垂直居中\"></a>多行文本水平垂直居中</h4><p>代码：<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">p</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#F44343</span>;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">300px</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: center;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-tag\">span</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</div><div class=\"line\">    <span class=\"attribute\">display</span>: inline-block;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: normal;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: left;</div><div class=\"line\">    <span class=\"attribute\">vertical-align</span>: middle;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>多行文本水平垂直居中多行文本水平垂直居中多行文本水平垂直居中多行文本水平垂直居中多行文本水平垂直居中<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/17.png\" alt=\"multiline center\"><br>注意：关键在于把多行文本所在容器的display水平设为inline-block，以及重置外部继承的text-align和line-height属性值。这里是<strong>近似垂直居中</strong>，因为字体的中线的位置与实际的居中位置是不同的，不同的字体的中线位置也有区别。IE8+兼容。</p>\n<h2 id=\"相对定位（relative-positioning）\"><a href=\"#相对定位（relative-positioning）\" class=\"headerlink\" title=\"相对定位（relative positioning）\"></a>相对定位（relative positioning）</h2><h3 id=\"常规流中的占位\"><a href=\"#常规流中的占位\" class=\"headerlink\" title=\"常规流中的占位\"></a>常规流中的占位</h3><p>相对定位元素处于常规流中，相对于元素在常规流中的原位置进行定位，偏移后，在常规流中依然占据原有位置，不会影响其它元素的布局，但是<strong>相对定位后</strong>，<strong>它的层叠上下文级别提高了</strong>，<strong>意味着可能产生框的重叠</strong>，也就是挡住其它的元素。关于层叠上下文，就不深入了，又是另一个深坑了，想了解就自行百度层叠上下文及层叠水平进行了解。</p>\n<h3 id=\"溢出包含块\"><a href=\"#溢出包含块\" class=\"headerlink\" title=\"溢出包含块\"></a>溢出包含块</h3><p>如果相对定位引起 “overflow:auto” 或 “overflow:scroll” 框的溢出，浏览器必须允许用户访问内容，既，创建需要的滚动条，这可能会影响布局。<br>代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width:100px; height:100px; overflow:auto; border:2px solid blue;\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width:40px; height:40px; background-color:red; position:relative; top:100px; left:100px;\"</span>&gt;</span>X<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>页面：<br><img src=\"http://charles-hang.github.io/images/16_9_10/18.png\" alt=\"overflow block1\"><br><img src=\"http://charles-hang.github.io/images/16_9_10/19.png\" alt=\"overflow block2\"></p>\n<h3 id=\"定位的计算\"><a href=\"#定位的计算\" class=\"headerlink\" title=\"定位的计算\"></a>定位的计算</h3><p>top/bottom 同时存在时，top起作用，bottom无效。<br>left/right 同时存在时，如果包含块的direction属性是ltr， 那么left起作用，right无效；如果包含块的direction属性是rtl，那么right起作用，left无效。</p>\n<h3 id=\"相对定位最小化影响原则\"><a href=\"#相对定位最小化影响原则\" class=\"headerlink\" title=\"相对定位最小化影响原则\"></a>相对定位最小化影响原则</h3><p>上面说到相对定位会影响层叠上下文，这就可能带来许多想不到的遮挡、覆盖问题。所以在<strong>平时布局中要将relative的影响最小化</strong>。那么怎么做呢？<br>平时，我们想对一个元素绝对定位时，总是在其父级上添加relative定位属性，在通过top、left、right、bottom对其调整定位。其实这是个不好的习惯，这增加了出现问题的潜在风险，对父级来说relative定位属性是毫无用处的。这时就应该使用<strong>无依赖的绝对定位</strong>（不用relative帮助），具体属于下篇绝对定位的内容了，敬请期待！再有，当无依赖绝对定位难以达到要求必须借助relative帮助时，我们应该将绝对定位元素单独提取出来，为其添加一个相对定位的父级来帮助其定位，类似如下：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"position: relative;\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"***.png\"</span> <span class=\"attr\">alt</span>=<span class=\"string\">\"***\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"position: absolute; top: 0; right: 0;\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>这样就大大降低了出现问题的可能。</p>\n<p>下篇讲浮动和绝对定位这两大头！</p>\n","categories":["css"],"tags":["学习笔记","css定位"]},{"title":"category","url":"http://charles-hang.github.io/category/index.html","content":"","categories":[],"tags":[]},{"title":"about","url":"http://charles-hang.github.io/about/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://charles-hang.github.io/search/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"http://charles-hang.github.io/project/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://charles-hang.github.io/tag/index.html","content":"","categories":[],"tags":[]}]